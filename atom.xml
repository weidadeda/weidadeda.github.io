<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://weidadeda.github.io</id>
    <title>å¤§ä¼Ÿçš„åšå®¢</title>
    <updated>2022-02-14T13:08:25.545Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://weidadeda.github.io"/>
    <link rel="self" href="https://weidadeda.github.io/atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://weidadeda.github.io/images/avatar.png</logo>
    <icon>https://weidadeda.github.io/favicon.ico</icon>
    <rights>All rights reserved 2022, å¤§ä¼Ÿçš„åšå®¢</rights>
    <entry>
        <title type="html"><![CDATA[è‡ªå®šä¹‰ä¸€ä¸ªWebPackçš„æ’ä»¶]]></title>
        <id>https://weidadeda.github.io/post/zi-ding-yi-yi-ge-webpack-de-cha-jian</id>
        <link href="https://weidadeda.github.io/post/zi-ding-yi-yi-ge-webpack-de-cha-jian">
        </link>
        <updated>2022-02-14T10:32:14.000Z</updated>
        <content type="html"><![CDATA[<h3 id="1-webpackæ’ä»¶çš„åŸºæœ¬åŸç†">1ã€webpackæ’ä»¶çš„åŸºæœ¬åŸç†</h3>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œwebpack å°±åƒä¸€æ¡ç”Ÿäº§çº¿,è¦ç»è¿‡ä¸€ç³»åˆ—å¤„ç†æµç¨‹åæ‰èƒ½å°†æºæ–‡ä»¶è½¬æ¢æˆè¾“å‡ºç»“æœã€‚ è¿™æ¡ç”Ÿäº§çº¿ä¸Šçš„æ¯ä¸ªå¤„ç†æµç¨‹çš„èŒè´£éƒ½æ˜¯å•ä¸€çš„,å¤šä¸ªæµç¨‹ä¹‹é—´æœ‰å­˜åœ¨ä¾èµ–å…³ç³»,åªæœ‰å®Œæˆå½“å‰å¤„ç†åæ‰èƒ½äº¤ç»™ä¸‹ä¸€ä¸ªæµç¨‹å»å¤„ç†ã€‚ æ’ä»¶å°±åƒæ˜¯ä¸€ä¸ªæ’å…¥åˆ°ç”Ÿäº§çº¿ä¸­çš„ä¸€ä¸ªåŠŸèƒ½,åœ¨ç‰¹å®šçš„æ—¶æœºå¯¹ç”Ÿäº§çº¿ä¸Šçš„èµ„æºåšå¤„ç†ã€‚<br>
webpack é€šè¿‡ Tapable æ¥ç»„ç»‡è¿™æ¡å¤æ‚çš„ç”Ÿäº§çº¿ã€‚ webpack åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¼šå¹¿æ’­äº‹ä»¶,æ’ä»¶åªéœ€è¦ç›‘å¬å®ƒæ‰€å…³å¿ƒçš„äº‹ä»¶,å°±èƒ½åŠ å…¥åˆ°è¿™æ¡ç”Ÿäº§çº¿ä¸­,å»æ”¹å˜ç”Ÿäº§çº¿çš„è¿ä½œã€‚ webpack çš„äº‹ä»¶æµæœºåˆ¶ä¿è¯äº†æ’ä»¶çš„æœ‰åºæ€§,ä½¿å¾—æ•´ä¸ªç³»ç»Ÿæ‰©å±•æ€§å¾ˆå¥½ã€‚</p>
<blockquote>
<p>tapable æ˜¯ä¸€ä¸ªç±»ä¼¼äº Node.js ä¸­çš„ EventEmitterçš„åº“ï¼Œä½†æ›´ä¸“æ³¨äºè‡ªå®šä¹‰äº‹ä»¶çš„è§¦å‘å’Œå¤„ç†ã€‚webpack é€šè¿‡ tapable å°†å®ç°ä¸æµç¨‹è§£è€¦ï¼Œæ‰€æœ‰å…·ä½“å®ç°é€šè¿‡æ’ä»¶çš„å½¢å¼å­˜åœ¨ã€‚</p>
</blockquote>
<ul>
<li>tapableä½œä¸ºwebpackçš„ä¸»æ¨¡å—ï¼Œéœ€è¦å•ç‹¬æŠ½ä¸€ç¯‡å‡ºæ¥è®²ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ è¦å†™sdkéœ€è¦å‘å¤–å±‚åéœ²æ•°æ®çš„è¯ï¼Œå»ºè®®è¿˜æ˜¯ç”¨EventEmitteråº“ï¼Œä¸å»ºè®®ç”¨tapableï¼Œå› ä¸ºå®ƒé”€æ¯å…¨éƒ¨æ³¨å†Œäº‹ä»¶ä¸æ˜¯å¾ˆå®¹æ˜“ã€‚<br>
å¥½äº†ï¼Œå†™webpackæ’ä»¶å¿…é¡»è¦äº†è§£tapableï¼Œè¿™é‡Œæˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸€ä¸‹å®ƒçš„å‡ ä¸ªå¸¸ç”¨çš„é’©å­ï¼Œå…¶ä»–çš„å¯ä»¥ç½‘ä¸ŠæŸ¥ï¼Œè¿™é‡Œæœ‰ç¯‡å†™çš„è¿˜ä¸é”™<a href="https://blog.csdn.net/mafan121/article/details/113120081">tapableè¯¦è§£</a></li>
</ul>
<pre><code>const {
  SyncHook,
  SyncBailHook,
  SyncWaterfallHook,
  SyncLoopHook,
  AsyncParallelHook,
  AsyncParallelBailHook,
  AsyncSeriesHook,
  AsyncSeriesBailHook,
  AsyncSeriesWaterfallHook
} = require('tapable');
</code></pre>
<h3 id="tapableé€šè¿‡tapæ³¨å†Œä¸€ä¸ªäº‹ä»¶é€šè¿‡callæ‰§è¡Œè¯¥é’©å­æ³¨å†Œçš„æ‰€æœ‰äº‹ä»¶-tapableçš„æ¯ä¸ªhookséƒ½tapä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶-tapasynccallasync-tappromisepromiseç”¨äºæ³¨å†ŒåŒæ­¥æ‰§è¡Œçš„å¼‚æ­¥äº‹ä»¶callasyncç”¨åœ¨å¹¶è¡Œæ‰§è¡Œçš„å¼‚æ­¥é’©å­å®Œæˆåå†æ‰§è¡Œè¯¥å‡½æ•°">tapableé€šè¿‡tapæ³¨å†Œä¸€ä¸ªäº‹ä»¶ï¼Œé€šè¿‡callæ‰§è¡Œè¯¥é’©å­æ³¨å†Œçš„æ‰€æœ‰äº‹ä»¶ã€‚tapableçš„æ¯ä¸ªhookséƒ½tapä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶ã€‚tapAsync/callAsyncã€tapPromise/Promiseç”¨äºæ³¨å†ŒåŒæ­¥æ‰§è¡Œçš„å¼‚æ­¥äº‹ä»¶ï¼ŒcallAsyncç”¨åœ¨å¹¶è¡Œæ‰§è¡Œçš„å¼‚æ­¥é’©å­å®Œæˆåå†æ‰§è¡Œè¯¥å‡½æ•°ã€‚</h3>
<p>å…·ä½“ä½¿ç”¨ä¸¾ä¸ªä¾‹å­ï¼ˆæ¯”å¦‚SyncHookï¼Œä¾æ¬¡æ‰§è¡Œæ³¨å†Œäº‹ä»¶ï¼Œæ— æ³•ä¸­æ–­ï¼‰</p>
<pre><code> const hook = new SyncHook(['name', 'sex'])
  /*
  tap(options,function):
  optionsæ˜¯äº‹ä»¶æè¿°ï¼Œå¯ä»¥ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥ä¸ºä¸€ä¸ªå¯¹è±¡,ä¸ºå¯¹è±¡æ—¶å¿…é¡»åŒ…å«nameå±æ€§ï¼Œæè¿°è¯¥æ’ä»¶åç§°ã€‚
  function:å›è°ƒå‡½æ•°
  */
  // æ‰“å°æˆ‘çš„åå­—
  hook.tap('printName', (name) =&gt; {
    console.log('my name is ' + name);
  })
  hook.tap('printSex', (name, sex) =&gt; {
    console.log('Iâ€™m a ' + sex);
  })
  // call(arg1,arg2,...)
  hook.call('å¼ ä¸‰', 'man');

  æ‰§è¡Œç»“æœï¼š

    my name is å¼ ä¸‰

    Iâ€™m a man
</code></pre>
<p>å¥½äº†ï¼Œè¯´äº†ä¸€å †tapableäº†ï¼Œè¯¥è¯´webpackæ’ä»¶äº†ã€‚</p>
<p><a href="https://www.webpackjs.com/contribute/writing-a-plugin/">å®˜ç½‘æä¾›çš„è‡ªå®šä¹‰æ’ä»¶æ–‡æ¡£</a></p>
<p>webpack æ’ä»¶ç”±ä»¥ä¸‹ç»„æˆï¼š</p>
<ul>
<li>ä¸€ä¸ª JavaScript å‘½åå‡½æ•°ã€‚</li>
<li>åœ¨æ’ä»¶å‡½æ•°çš„ prototype ä¸Šå®šä¹‰ä¸€ä¸ª apply æ–¹æ³•ã€‚</li>
<li>æŒ‡å®šä¸€ä¸ªç»‘å®šåˆ° webpack è‡ªèº«çš„äº‹ä»¶é’©å­ã€‚</li>
<li>å¤„ç† webpack å†…éƒ¨å®ä¾‹çš„ç‰¹å®šæ•°æ®ã€‚</li>
<li>åŠŸèƒ½å®Œæˆåè°ƒç”¨ webpack æä¾›çš„å›è°ƒã€‚</li>
</ul>
<p>ä¸‹é¢æ˜¯å®˜ç½‘çš„ç®€å•ä¾‹å­ï¼š</p>
<pre><code class="language-js">// ä¸€ä¸ª JavaScript å‘½åå‡½æ•°ã€‚
function MyExampleWebpackPlugin() {

};

// åœ¨æ’ä»¶å‡½æ•°çš„ prototype ä¸Šå®šä¹‰ä¸€ä¸ª `apply` æ–¹æ³•ã€‚
MyExampleWebpackPlugin.prototype.apply = function(compiler) {
  // æŒ‡å®šä¸€ä¸ªæŒ‚è½½åˆ° webpack è‡ªèº«çš„äº‹ä»¶é’©å­ã€‚
  compiler.plugin('webpacksEventHook', function(compilation /* å¤„ç† webpack å†…éƒ¨å®ä¾‹çš„ç‰¹å®šæ•°æ®ã€‚*/, callback) {
    console.log(&quot;This is an example plugin!!!&quot;);

    // åŠŸèƒ½å®Œæˆåè°ƒç”¨ webpack æä¾›çš„å›è°ƒã€‚
    callback();
  });
};
</code></pre>
<p>åœ¨æˆ‘ä»¬ä½¿ç”¨è¯¥pluginçš„æ—¶å€™ï¼Œç›¸å…³è°ƒç”¨åŠé…ç½®ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-js">const MyExampleWebpackPlugin = require('./MyExampleWebpackPlugin');
module.exports = {
  plugins: [
    new MyExampleWebpackPlugin(options)
  ]
};
</code></pre>
<p>æˆ‘å¼€å§‹è¯´äº†ä¸€å¤§å †tapableï¼Œå…¶å®å°±æ˜¯ä¸ºäº†è¯´æ˜ç™½webpackæ’ä»¶çš„åŸç†</p>
<p>ç”¨ä»£ç è¯´æ˜å§ï¼Œä¸€ä¸ªcompiler.jsï¼Œä¸€ä¸ªmain.js<br>
compiler.js</p>
<pre><code class="language-js">// éœ€è¦åšçš„äº‹æƒ…å¦‚ä¸‹ï¼š
// 1. å®šä¹‰ä¸€ä¸ª Compiler ç±»ï¼Œæ¥æ”¶ä¸€ä¸ªoptionså¯¹è±¡å‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯ä»main.jsä¸­çš„MyPluginç±»çš„å®åˆ—å¯¹è±¡ã€‚è¯¥å¯¹è±¡ä¸‹æœ‰ applyå‡½æ•°ã€‚

// 2. åœ¨è¯¥ç±»ä¸­æˆ‘ä»¬å®šä¹‰äº†runæ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨main.js ä¸­æ‰§è¡Œè¯¥runå‡½æ•°å°±å¯ä»¥è‡ªåŠ¨æ‰§è¡Œå¯¹åº”çš„æ’ä»¶äº†ã€‚

const { SyncHook, AsyncParallelHook } = require('tapable');

class Compiler {
  constructor(options) {
    this.hooks = {
      kzSyncHook: new SyncHook(['name', 'age']),
      kzAsyncHook: new AsyncParallelHook(['name', 'age'])
    };
    let plugins = options.plugins;
    if (plugins &amp;&amp; plugins.length &gt; 0) {
      plugins.forEach(plugin =&gt; plugin.apply(this));
    }
  }
  run() {
    console.log('å¼€å§‹æ‰§è¡Œäº†---------');
    this.kzSyncHook('æˆ‘æ˜¯å°æ˜', 81);
    this.kzAsyncHook('æˆ‘æ˜¯å°çº¢', 91);
  }
  kzSyncHook(name, age) {
    this.hooks.kzSyncHook.call(name, age);
  }
  kzAsyncHook(name, age) {
    this.hooks.kzAsyncHook.callAsync(name, age);
  }
}

module.exports = Compiler;
</code></pre>
<p>main.js</p>
<pre><code class="language-js">// éœ€è¦åšçš„äº‹æƒ…å¦‚ä¸‹ï¼š
// 1. å¼•å…¥ compiler.js æ–‡ä»¶ã€‚
// 2. å®šä¹‰ä¸€ä¸ªè‡ªå·±çš„æ’ä»¶ï¼Œæ¯”å¦‚å« MyPlugin ç±»ï¼Œè¯¥ç±»ä¸‹æœ‰ apply å‡½æ•°ã€‚è¯¥å‡½æ•°æœ‰ä¸€ä¸ª compiler å‚æ•°ï¼Œè¯¥å‚æ•°å°±æ˜¯æˆ‘ä»¬çš„ compiler.js ä¸­çš„å®åˆ—å¯¹è±¡ã€‚ç„¶åæˆ‘ä»¬ä¼šä½¿ç”¨ compiler å®åˆ—å¯¹è±¡å»è°ƒç”¨ compiler.js é‡Œé¢çš„å‡½æ•°ã€‚å› æ­¤å°±å¯ä»¥è‡ªåŠ¨æ‰§è¡Œäº†ã€‚
const Compiler = require('./compiler');

class MyPlugin {
  constructor() {
    
  }
  apply(compiler) {
    compiler.hooks.kzSyncHook.tap(&quot;eventName1&quot;, (name, age) =&gt; {
      console.log(`åŒæ­¥äº‹ä»¶eventName1ï¼š ${name} this year ${age} å‘¨å²äº†, å¯æ˜¯è¿˜æ˜¯å•èº«`);
    });
    compiler.hooks.kzAsyncHook.tapAsync('eventName2', (name, age) =&gt; {
      setTimeout(() =&gt; {
        console.log(`å¼‚æ­¥äº‹ä»¶eventName2ï¼š ${name} this year ${age}å‘¨å²äº†ï¼Œå¯æ˜¯è¿˜æ˜¯å•èº«`);
      }, 1000)
    });
  }
}

const myPlugin = new MyPlugin();

const options = {
  plugins: [myPlugin]
};

const compiler = new Compiler(options);
compiler.run();
</code></pre>
<p>çœ‹åˆ°æ²¡ï¼Œè¿™ç§ä½¿ç”¨æ–¹å¼æ˜¯ä¸æ˜¯å’Œå®˜ç½‘çš„ä½¿ç”¨æ–¹å¼å¾ˆç›¸ä¼¼ï½è¿™å›çŸ¥é“åŸç†äº†å§ï½</p>
<p>ç°åœ¨çœ‹å®˜ç½‘çš„ç®€å•ä¾‹å­ï¼Œwebpackå¯åŠ¨åï¼Œåœ¨è¯»å–é…ç½®çš„è¿‡ç¨‹ä¸­ä¼šå…ˆæ‰§è¡Œ new MyExampleWebpackPlugin(options) åˆå§‹åŒ–MyExampleWebpackPluginæ¥è·å¾—ä¸€ä¸ªå®ä¾‹ã€‚<br>
ç„¶åæˆ‘ä»¬ä¼šæŠŠè¯¥å®ä¾‹å½“åšå‚æ•°ä¼ é€’ç»™æˆ‘ä»¬çš„Compilerå¯¹è±¡ï¼Œç„¶åä¼šå®ä¾‹åŒ– Compilerç±»(è¿™ä¸ªé€»è¾‘å¯ä»¥ç»“åˆçœ‹æˆ‘ä»¬ä¸Šé¢å®ç°äº†ä¸€ä¸ªç®€å•çš„demoä¸­ çš„main.jså’Œcompiler.jsçš„ä»£ç ç»“åˆèµ·æ¥ç†è§£)ã€‚åœ¨Compilerç±»ä¸­ï¼Œæˆ‘ä»¬ä¼šè·å–åˆ°optionsçš„è¿™ä¸ªå‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸‹æœ‰ä¸€ä¸ª plugins è¿™ä¸ªå±æ€§ã€‚<br>
ç„¶åéå†è¯¥å±æ€§ï¼Œç„¶åä¾æ¬¡æ‰§è¡Œ æŸé¡¹æ’ä»¶ä¸­çš„applyæ–¹æ³•ï¼Œå³ï¼šmyExampleWebpackPlugin.apply(compiler); ç»™æ’ä»¶ä¼ é€’compilerå¯¹è±¡ã€‚æ’ä»¶å®ä¾‹è·å–è¯¥compilerå¯¹è±¡åï¼Œå°±å¯ä»¥é€šè¿‡ compiler.plugin('äº‹ä»¶åç§°', 'å›è°ƒå‡½æ•°'); ç›‘å¬åˆ°webpackå¹¿æ’­å‡ºæ¥çš„äº‹ä»¶.(è¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å¯ä»¥çœ‹æˆ‘ä»¬ä¸Šé¢çš„main.jsä¸­çš„å¦‚ä¸‹ä»£ç å¯ä»¥çœ‹åˆ°, åœ¨æˆ‘ä»¬çš„main.jsä»£ç ä¸­æœ‰è¿™æ ·ä»£ç ï¼šcompiler.hooks.kzSyncHook.tap(&quot;eventName1&quot;, (name, age) =&gt; {}));</p>
<p>å¦‚ä¸Šå°±æ˜¯ä¸€ä¸ªç®€å•çš„Pluginçš„æ’ä»¶åŸç†(åˆ‡è®°ï¼šç»“åˆä¸Šé¢çš„demoä¸­main.jså’Œcompiller.jsæ¥ç†è§£æ•ˆæœä¼šæ›´å¥½)ã€‚</p>
<h3 id="2-compiler-å’Œ-compilation">2ã€Compiler å’Œ Compilation</h3>
<p>åœ¨å¼€å‘Pluginæ—¶æˆ‘ä»¬æœ€å¸¸ç”¨çš„ä¸¤ä¸ªå¯¹è±¡å°±æ˜¯ Compiler å’Œ Compilation, ä»–ä»¬æ˜¯Pluginå’Œwebpackä¹‹é—´çš„æ¡¥æ¢ã€‚</p>
<h4 id="compilerå¯¹è±¡">Compilerå¯¹è±¡</h4>
<p>Compilerå¯¹è±¡åŒ…å«äº†Webpackç¯å¢ƒæ‰€æœ‰çš„é…ç½®ä¿¡æ¯ï¼ŒåŒ…å«optionsï¼Œloaders, pluginsè¿™äº›é¡¹ï¼Œè¿™ä¸ªå¯¹è±¡åœ¨webpackå¯åŠ¨æ—¶å€™è¢«å®ä¾‹åŒ–ï¼Œå®ƒæ˜¯å…¨å±€å”¯ä¸€çš„ã€‚æˆ‘ä»¬å¯ä»¥æŠŠå®ƒç†è§£ä¸ºwebpackçš„å®ä¾‹ã€‚</p>
<p>åŸºæœ¬æºç å¯ä»¥çœ‹å¦‚ä¸‹ï¼š</p>
<pre><code>// webpack/lib/webpack.js
const Compiler = require(&quot;./Compiler&quot;)

const webpack = (options, callback) =&gt; {
  ...
  // åˆå§‹åŒ– webpack å„é…ç½®å‚æ•°
  options = new WebpackOptionsDefaulter().process(options);

  // åˆå§‹åŒ– compiler å¯¹è±¡ï¼Œè¿™é‡Œ options.context ä¸º process.cwd()
  let compiler = new Compiler(options.context);

  compiler.options = options                               // å¾€ compiler æ·»åŠ åˆå§‹åŒ–å‚æ•°

  new NodeEnvironmentPlugin().apply(compiler)              // å¾€ compiler æ·»åŠ  Node ç¯å¢ƒç›¸å…³æ–¹æ³•

  for (const plugin of options.plugins) {
    plugin.apply(compiler);
  }
  ...
}
</code></pre>
<blockquote>
<p><a href="https://github.com/webpack/webpack/blob/10282ea20648b465caec6448849f24fc34e1ba3e/lib/webpack.js#L30">æºç å¯ä»¥ç‚¹å‡»è¿™é‡Œ</a></p>
</blockquote>
<p>å¦‚ä¸Šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒCompilerå¯¹è±¡åŒ…å«äº†æ‰€æœ‰çš„webpackå¯é…ç½®çš„å†…å®¹ã€‚å¼€å‘æ’ä»¶æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä» compiler å¯¹è±¡ä¸­æ‹¿åˆ°æ‰€æœ‰å’Œ webpack ä¸»ç¯å¢ƒç›¸å…³çš„å†…å®¹ã€‚</p>
<h4 id="compilationå¯¹è±¡">compilationå¯¹è±¡</h4>
<p>compilation å¯¹è±¡åŒ…å«äº†å½“å‰çš„æ¨¡å—èµ„æºã€ç¼–è¯‘ç”Ÿæˆèµ„æºã€æ–‡ä»¶çš„å˜åŒ–ç­‰ã€‚å½“webpackåœ¨å¼€å‘æ¨¡å¼ä¸‹è¿è¡Œæ—¶ï¼Œæ¯å½“æ£€æµ‹åˆ°ä¸€ä¸ªæ–‡ä»¶å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œé‚£ä¹ˆä¸€æ¬¡æ–°çš„ Compilationå°†ä¼šè¢«åˆ›å»ºã€‚ä»è€Œç”Ÿæˆä¸€ç»„æ–°çš„ç¼–è¯‘èµ„æºã€‚</p>
<p>Compilerå¯¹è±¡ ä¸ Compilation å¯¹è±¡ çš„åŒºåˆ«æ˜¯ï¼šCompilerä»£è¡¨äº†æ˜¯æ•´ä¸ªwebpackä»å¯åŠ¨åˆ°å…³é—­çš„ç”Ÿå‘½å‘¨æœŸã€‚Compilation å¯¹è±¡åªä»£è¡¨äº†ä¸€æ¬¡æ–°çš„ç¼–è¯‘ã€‚</p>
<p>Compilerå¯¹è±¡çš„äº‹ä»¶é’©å­:</p>
<pre><code>é’©å­               ä½œç”¨                     å‚æ•°               ç±»å‹
after-plugins     è®¾ç½®å®Œä¸€ç»„åˆå§‹åŒ–æ’ä»¶ä¹‹å    compiler          sync
after-resolvers   è®¾ç½®å®Œ resolvers ä¹‹å     compiler          sync
run               åœ¨è¯»å–è®°å½•ä¹‹å‰             compiler          async
compile           åœ¨åˆ›å»ºæ–° compilationä¹‹å‰  compilationParams  sync
compilation       compilation åˆ›å»ºå®Œæˆ      compilation        sync
emit              åœ¨ç”Ÿæˆèµ„æºå¹¶è¾“å‡ºåˆ°ç›®å½•ä¹‹å‰  compilation        async
after-emit        åœ¨ç”Ÿæˆèµ„æºå¹¶è¾“å‡ºåˆ°ç›®å½•ä¹‹å  compilation        async
done              å®Œæˆç¼–è¯‘                  stats              sync
</code></pre>
<blockquote>
<p><a href="https://github.com/webpack/webpack/blob/eca7bad8de54c39b9cb8b138793362b8a17ac11b/lib/Compiler.js#L32">æºç åœ°å€</a></p>
</blockquote>
<h4 id="ç†è§£webpackä¸­çš„äº‹ä»¶æµ">ç†è§£webpackä¸­çš„äº‹ä»¶æµ</h4>
<p>æˆ‘ä»¬å¯ä»¥æŠŠwebpackç†è§£ä¸ºä¸€æ¡ç”Ÿäº§çº¿ï¼Œéœ€è¦ç»è¿‡ä¸€ç³»åˆ—å¤„ç†æµç¨‹åæ‰èƒ½å°†æºæ–‡ä»¶è½¬æ¢æˆè¾“å‡ºç»“æœã€‚<br>
è¿™æ¡ç”Ÿäº§çº¿ä¸Šçš„æ¯ä¸ªå¤„ç†æµç¨‹çš„èŒè´£éƒ½æ˜¯å•ä¸€çš„ï¼Œå¤šä¸ªæµç¨‹ä¹‹é—´ä¼šå­˜åœ¨ä¾èµ–å…³ç³»ï¼Œåªæœ‰å®Œæˆå½“å‰å¤„ç†åæ‰èƒ½äº¤ç»™ä¸‹ä¸€ä¸ªæµç¨‹å»å¤„ç†ã€‚</p>
<p>æˆ‘ä»¬çš„æ’ä»¶å°±åƒä¸€ä¸ªæ’å…¥åˆ°ç”Ÿäº§çº¿ä¸­çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œåœ¨ç‰¹å®šçš„æ—¶æœºå¯¹ç”Ÿäº§çº¿ä¸Šçš„èµ„æºä¼šåšå¤„ç†ã€‚webpackå®ƒæ˜¯é€šè¿‡ Tapableæ¥ç»„ç»‡è¿™æ¡å¤æ‚çš„ç”Ÿäº§çº¿çš„ã€‚</p>
<p>webpackåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ä¼šå¹¿æ’­äº‹ä»¶ï¼Œæ’ä»¶åªéœ€è¦å…³å¿ƒç›‘å¬å®ƒçš„äº‹ä»¶ï¼Œå°±èƒ½åŠ å…¥åˆ°è¿™æ¡ç”Ÿäº§çº¿ä¸­ã€‚ç„¶åä¼šæ‰§è¡Œç›¸å…³çš„æ“ä½œã€‚<br>
webpackçš„äº‹ä»¶æµæœºåˆ¶å®ƒèƒ½ä¿è¯äº†æ’ä»¶çš„æœ‰åºæ€§ï¼Œä½¿æ•´ä¸ªç³»ç»Ÿçš„æ‰©å±•æ€§å¥½ã€‚äº‹ä»¶æµæœºåˆ¶ä½¿ç”¨äº†è§‚å¯Ÿè€…æ¨¡å¼æ¥å®ç°çš„ã€‚æ¯”å¦‚å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code>/*
 * å¹¿æ’­äº‹ä»¶
 * myPlugin-name ä¸ºäº‹ä»¶åç§°
 * params ä¸ºé™„å¸¦çš„å‚æ•°
*/

compiler.apply('myPlugin-name', params); // myPlugin-nameéšä¾¿å†™ï¼Œå°±æ˜¯ä¸€ä¸ªåå­—

/*
 * ç›‘å¬åç§°ä¸º 'myPlugin-name' çš„äº‹ä»¶ï¼Œå½“ myPlugin-name äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå‡½æ•°å°±ä¼šæ‰§è¡Œã€‚
*/

compiler.hooks.myPlugin-name.tap('myPlugin-name', function(params) {
  
});
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[çŸ­ä¿¡çŸ­é“¾æ¥å”¤èµ·APP]]></title>
        <id>https://weidadeda.github.io/post/duan-xin-duan-lian-jie-huan-qi-app</id>
        <link href="https://weidadeda.github.io/post/duan-xin-duan-lian-jie-huan-qi-app">
        </link>
        <updated>2022-02-10T07:59:08.000Z</updated>
        <content type="html"><![CDATA[<figure data-type="image" tabindex="1"><img src="https://weidadeda.github.io/post-images/1644479995097.png" alt="" loading="lazy"></figure>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å¾®ä¿¡å…¬ä¼—å·è·å–openidç­‰ä¸€ç³»åˆ—æµç¨‹]]></title>
        <id>https://weidadeda.github.io/post/wei-xin-gong-zhong-hao-huo-qu-openid-deng-yi-xi-lie-liu-cheng</id>
        <link href="https://weidadeda.github.io/post/wei-xin-gong-zhong-hao-huo-qu-openid-deng-yi-xi-lie-liu-cheng">
        </link>
        <updated>2022-02-08T12:49:25.000Z</updated>
        <content type="html"><![CDATA[<h3 id="å…ˆè¯´ä¸‹ä¸ºä»€ä¹ˆè¦è·å–-openid">å…ˆè¯´ä¸‹ä¸ºä»€ä¹ˆè¦è·å– openid?</h3>
<p>å› ä¸ºç”¨æˆ·ç®¡ç†ç±»æ¥å£å¯ä»¥é€šè¿‡openidå¯ä»¥è·å–ç”¨æˆ·çš„ä¸€äº›ä¿¡æ¯çš„.</p>
<h3 id="è¯´åˆ°-openid-å¿…é¡»å…ˆè¯´å¾®ä¿¡æˆæƒç™»å½•çš„è¿‡ç¨‹">è¯´åˆ° openid å¿…é¡»å…ˆè¯´å¾®ä¿¡æˆæƒç™»å½•çš„è¿‡ç¨‹</h3>
<figure data-type="image" tabindex="1"><img src="https://weidadeda.github.io/post-images/1644479416142.png" alt="" loading="lazy"></figure>
<ul>
<li>
<p>å‰ç«¯éœ€è¦åœ¨è¿›å…¥è·¯ç”±çš„æ˜¯beaforEachçš„æ—¶å€™ï¼Œå…ˆå»åˆ¤æ–­é“¾æ¥ä¸Šæœ‰æ²¡æœ‰ openid</p>
</li>
<li>
<p>å¦‚æœæ²¡æœ‰ï¼Œå°±å»è·³è½¬åˆ°æœåŠ¡ç«¯ç»™çš„ä¸€ä¸ªåœ°å€ã€‚å¦‚æœæœ‰ï¼Œå°±ç»§ç»­å¾€ä¸‹èµ°ï¼ˆnext())</p>
</li>
<li>
<p>è¿™ä¸ªæ—¶å€™æœåŠ¡ç«¯ä¼šå¾€ä¸‹é¢çš„é“¾æ¥ï¼ˆhttps://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE#wechat_redirectæ¥è·å–codeï¼‰ä¸Šè·³è½¬ï¼Œå»å¼•å¯¼ç”¨æˆ·å»ç‚¹å‡»æˆæƒï¼Œç”¨æˆ·æˆæƒä¹‹åå°±ä¼šé‡å®šå‘åˆ° redirect_uriï¼ˆæœåŠ¡ç«¯çš„åœ°å€ï¼‰</p>
</li>
<li>
<p>åˆ©ç”¨ code è·å– openid ä¹‹å(æœåŠ¡ç«¯å»åš)ï¼ŒæœåŠ¡ç«¯ä¼šè·³è½¬åˆ°å‰ç«¯é¡µé¢(å¸¦ä¸Šopenid)</p>
</li>
</ul>
<p>ä¸‹é¢ä½œä¸ºäº†è§£ï¼š</p>
<p>å¾®ä¿¡æˆæƒä½¿ç”¨çš„æ˜¯ OAuth2.0æˆæƒæ–¹å¼ã€‚ä¸»è¦æœ‰ä»¥ä¸‹ç®€ç•¥çš„æ­¥éª¤ï¼š<br>
ç¬¬ä¸€æ­¥ï¼šç”¨æˆ·åŒæ„æˆæƒï¼Œè·å– code<br>
ã€€ã€€ç¬¬äºŒæ­¥ï¼šé€šè¿‡ codeè·å–ç½‘é¡µæˆæƒaccess_token<br>
ã€€ã€€ç¬¬ä¸‰æ­¥ï¼šåˆ·æ–°access_tokenï¼ˆå¦‚æœéœ€è¦ï¼‰<br>
ã€€ã€€ç¬¬å››æ­¥ï¼šæ‹‰å–ç”¨æˆ·ä¿¡æ¯(éœ€scopeä¸º snsapi_userinfo)</p>
<h3 id="ä¸‹é¢æ¥å…·ä½“apiè¡¨ç¤ºä¸‹æ€ä¹ˆè·å–çš„-code-å’Œ-openid-å§">ä¸‹é¢æ¥å…·ä½“apiè¡¨ç¤ºä¸‹æ€ä¹ˆè·å–çš„ code å’Œ openid å§</h3>
<h3 id="ä¸€è·å–code">ä¸€ï¼šè·å–code:</h3>
<p>é€šè¿‡https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&amp;redirect_uri=REDIRECT_URI&amp;response_type=code&amp;scope=SCOPE&amp;state=STATE#wechat_redirectæ¥è·å–code<br>
å‚æ•°ï¼š<br>
APPIDï¼šåº”ç”¨å”¯ä¸€æ ‡è¯†<br>
redirect_uriï¼šæˆæƒåé‡å®šå‘çš„å›è°ƒé“¾æ¥åœ°å€ï¼Œç”¨æˆ·åŒæ„åï¼Œcode ä¼šè‡ªåŠ¨æ·»åŠ åˆ°åé¢ã€‚ï¼ˆè¯·ä½¿ç”¨urlEncodeå¯¹é“¾æ¥è¿›è¡Œå¤„ç† ï¼ˆ$url = urlencode('')ï¼‰ ï¼‰<br>
scopeï¼šæ˜¯åº”ç”¨æˆæƒä½œç”¨åŸŸ ï¼ˆä¸€èˆ¬æœ‰ä¸¤ç§ï¼šä¸€ç§æ˜¯é™é»˜æ–¹å¼ï¼ˆsnsapi_base); ä¸€ç§æ˜¯éé™é»˜æ–¹å¼ï¼ˆsnsapi_userinfoï¼‰ï¼Œéœ€è¦ç”¨æˆ·å»æ‰‹åŠ¨åŒæ„æ‰èƒ½è·å–ç”¨æˆ·ä¿¡æ¯ï¼‰</p>
<p>å¾®ä¿¡ä¸­å°¤å…¶æé†’ï¼šç”±äºæˆæƒæ“ä½œå®‰å…¨ç­‰çº§è¾ƒé«˜ï¼Œæ‰€ä»¥åœ¨å‘èµ·æˆæƒè¯·æ±‚æ—¶ï¼Œå¾®ä¿¡ä¼šå¯¹æˆæƒé“¾æ¥åšæ­£åˆ™å¼ºåŒ¹é…æ ¡éªŒï¼Œå¦‚æœé“¾æ¥çš„å‚æ•°é¡ºåºä¸å¯¹ï¼Œæˆæƒé¡µé¢å°†æ— æ³•æ­£å¸¸è®¿é—®</p>
<p>** code æ˜¯å¾®ä¿¡è‡ªåŠ¨ç”Ÿæˆçš„ã€‚å¹¶ä¸”æ”¾åœ¨redirect_uriï¼ˆé‡å®šå‘åçš„å›è°ƒé“¾æ¥åœ°å€ï¼‰åé¢,å¹¶ä¸”å¸¦ä¸Šcodeå’Œstateå‚æ•°</p>
<p>ä¸Šé¢æåˆ°äº† codeã€‚é‚£ä¹ˆ codeåˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ<br>
code:ä½œä¸ºæ¢å– access_tokençš„ç¥¨æ®ï¼Œæ¯æ¬¡ç”¨æˆ·æˆæƒå¸¦ä¸Šçš„ code éƒ½ä¸ä¸€æ ·ã€‚5åˆ†é’Ÿæœªè¢«ä½¿ç”¨è‡ªåŠ¨è¿‡æœŸï¼ˆè¿‡æœŸçš„è¿™é‡Œä¸‹é¢æœ‰è®²ï¼‰</p>
<h3 id="äºŒç„¶åæˆæƒæˆåŠŸä¹‹å-å¾—åˆ°-code-å°±ç”¨-code-å»è·å–access_token">äºŒï¼šç„¶åæˆæƒæˆåŠŸä¹‹åã€‚å¾—åˆ° codeã€‚å°±ç”¨ code å»è·å–access_token</h3>
<p>https://api.weixin.qq.com/sns/oauth2/access_token?appid=wx41cb8dbd827a16e9&amp;secret=d4624c36b6795d1d99dcf0547af5443d&amp;code=00137323023ab55775be09d6d8e75ffA&amp;grant_type=authorization_code<br>
å‚æ•°è¯´æ˜ï¼š<br>
appidï¼šåº”ç”¨å”¯ä¸€æ ‡è¯†<br>
codeï¼šä¸Šä¸€æ­¥å·²ç»è·å–åˆ°äº†<br>
secretï¼šåº”ç”¨å¯†é’¥AppSecretï¼Œåœ¨å¾®ä¿¡å¼€æ”¾å¹³å°æäº¤åº”ç”¨å®¡æ ¸é€šè¿‡åè·å¾—</p>
<p>æ­£ç¡®çš„è¿”å›<br>
&quot;access_token&quot;:&quot;ACCESS_TOKEN&quot;, // æ¥å£è°ƒç”¨å‡­è¯ &quot;expires_in&quot;:7200, // access_tokenæ¥å£è°ƒç”¨å‡­è¯è¶…æ—¶æ—¶é—´ &quot;refresh_token&quot;:&quot;REFRESH_TOKEN&quot;, // ç”¨æˆ·åˆ·æ–°access_token &quot;openid&quot;:&quot;OPENID&quot;, // æˆæƒç”¨æˆ·å”¯ä¸€æ ‡è¯† &quot;scope&quot;:&quot;SCOPE&quot;, // ä½œç”¨åŸŸ ç­‰</p>
<h3 id="ä¸‰é€šè¿‡access_token-openidè·å–ç”¨æˆ·ä¿¡æ¯">ä¸‰ï¼šé€šè¿‡access_tokenã€openidè·å–ç”¨æˆ·ä¿¡æ¯</h3>
<p>https://api.weixin.qq.com/sns/userinfo?access_token=ACCESS_TOKEN&amp;openid=OPENID<br>
å°±ä¼šå¾—åˆ°ç”¨æˆ·çš„ä¿¡æ¯ï¼š<br>
å¾—åˆ°å‚æ•°ï¼š<br>
openidï¼šç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†<br>
nicknameï¼šç”¨æˆ·æ˜µç§°<br>
sexï¼š ç”·å¥³<br>
ç­‰ã€‚ã€‚ã€‚<br>
ç‰¹åˆ«æ³¨æ„ï¼š<br>
1ã€Appsecret æ˜¯åº”ç”¨æ¥å£ä½¿ç”¨å¯†é’¥ï¼Œæ³„æ¼åå°†å¯èƒ½å¯¼è‡´åº”ç”¨æ•°æ®æ³„æ¼ã€åº”ç”¨çš„ç”¨æˆ·æ•°æ®æ³„æ¼ç­‰é«˜é£é™©åæœï¼›å­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œææœ‰å¯èƒ½è¢«æ¶æ„çªƒå–ï¼ˆå¦‚åç¼–è¯‘è·å–Appsecretï¼‰ï¼› 2ã€access_token ä¸ºç”¨æˆ·æˆæƒç¬¬ä¸‰æ–¹åº”ç”¨å‘èµ·æ¥å£è°ƒç”¨çš„å‡­è¯ï¼ˆç›¸å½“äºç”¨æˆ·ç™»å½•æ€ï¼‰ï¼Œå­˜å‚¨åœ¨å®¢æˆ·ç«¯ï¼Œå¯èƒ½å‡ºç°æ¶æ„è·å–access_token åå¯¼è‡´çš„ç”¨æˆ·æ•°æ®æ³„æ¼ã€ç”¨æˆ·å¾®ä¿¡ç›¸å…³æ¥å£åŠŸèƒ½è¢«æ¶æ„å‘èµ·ç­‰è¡Œä¸ºï¼› 3ã€refresh_token ä¸ºç”¨æˆ·æˆæƒç¬¬ä¸‰æ–¹åº”ç”¨çš„é•¿æ•ˆå‡­è¯ï¼Œä»…ç”¨äºåˆ·æ–°access_tokenï¼Œä½†æ³„æ¼åç›¸å½“äºaccess_token æ³„æ¼ï¼Œé£é™©åŒä¸Šã€‚ å»ºè®®å°†secretã€ç”¨æˆ·æ•°æ®ï¼ˆå¦‚access_tokenï¼‰æ”¾åœ¨Appäº‘ç«¯æœåŠ¡å™¨ï¼Œç”±äº‘ç«¯ä¸­è½¬æ¥å£è°ƒç”¨è¯·æ±‚ã€‚</p>
<h3 id="æœ€åæ€»ç»“ä¸‹è¯¦ç»†çš„æ­¥éª¤">æœ€åæ€»ç»“ä¸‹è¯¦ç»†çš„æ­¥éª¤ï¼š</h3>
<ul>
<li>1ï¼ç”¨æˆ·å…³æ³¨å¾®ä¿¡å…¬ä¼—è´¦å·ã€‚</li>
<li>2ï¼å¾®ä¿¡å…¬ä¼—è´¦å·æä¾›ç”¨æˆ·è¯·æ±‚æˆæƒé¡µé¢URLã€‚</li>
<li>3ï¼ç”¨æˆ·ç‚¹å‡»æˆæƒé¡µé¢URLï¼Œå°†å‘æœåŠ¡å™¨å‘èµ·è¯·æ±‚</li>
<li>4ï¼æœåŠ¡å™¨è¯¢é—®ç”¨æˆ·æ˜¯å¦åŒæ„æˆæƒç»™å¾®ä¿¡å…¬ä¼—è´¦å·(scopeä¸ºsnsapi_baseæ—¶æ— æ­¤æ­¥éª¤)</li>
<li>5ï¼ç”¨æˆ·åŒæ„(scopeä¸ºsnsapi_baseæ—¶æ— æ­¤æ­¥éª¤)</li>
<li>6ï¼æœåŠ¡å™¨å°†CODEé€šè¿‡å›è°ƒä¼ ç»™å¾®ä¿¡å…¬ä¼—è´¦å·</li>
<li>7ï¼å¾®ä¿¡å…¬ä¼—è´¦å·è·å¾—CODE</li>
<li>8ï¼å¾®ä¿¡å…¬ä¼—è´¦å·é€šè¿‡CODEå‘æœåŠ¡å™¨è¯·æ±‚Access Token</li>
<li>9ï¼æœåŠ¡å™¨è¿”å›Access Tokenå’ŒOpenIDç»™å¾®ä¿¡å…¬ä¼—è´¦å·</li>
<li>10ï¼å¾®ä¿¡å…¬ä¼—è´¦å·é€šè¿‡Access Tokenå‘æœåŠ¡å™¨è¯·æ±‚ç”¨æˆ·ä¿¡æ¯(scopeä¸ºsnsapi_baseæ—¶æ— æ­¤æ­¥éª¤)</li>
<li>11ï¼æœåŠ¡å™¨å°†ç”¨æˆ·ä¿¡æ¯å›é€ç»™å¾®ä¿¡å…¬ä¼—è´¦å·(scopeä¸ºsnsapi_baseæ—¶æ— æ­¤æ­¥éª¤)</li>
</ul>
<p>å…¬ä¼—å·é“¾æ¥(å®˜ç½‘æ›´æƒå¨)ï¼š<br>
https://developers.weixin.qq.com/doc/oplatform/Website_App/WeChat_Login/Wechat_Login.html</p>
<p>https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/Wechat_webpage_authorization.html</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Airbnb CSS / Sass è§„èŒƒæŒ‡å—]]></title>
        <id>https://weidadeda.github.io/post/airbnb-css-sass-gui-fan-zhi-nan</id>
        <link href="https://weidadeda.github.io/post/airbnb-css-sass-gui-fan-zhi-nan">
        </link>
        <updated>2022-01-05T08:18:02.000Z</updated>
        <content type="html"><![CDATA[<blockquote>
<p><em>ç”¨æ›´åˆç†çš„æ–¹å¼å†™ CSS å’Œ Sass</em> ç¿»è¯‘è‡ª<a href="https://github.com/airbnb/css">Airbnb CSS / Sass Styleguide</a></p>
</blockquote>
<h3 id="æœ¯è¯­">æœ¯è¯­</h3>
<h4 id="è§„åˆ™å£°æ˜">è§„åˆ™å£°æ˜</h4>
<p>æˆ‘ä»¬æŠŠä¸€ä¸ªï¼ˆæˆ–ä¸€ç»„ï¼‰é€‰æ‹©å™¨å’Œä¸€ç»„å±æ€§ç§°ä¹‹ä¸º â€œè§„åˆ™å£°æ˜â€ã€‚ä¸¾ä¸ªä¾‹å­ï¼š</p>
<pre><code class="language-css">.listing {
  font-size: 18px;
  line-height: 1.2;
}
</code></pre>
<h4 id="é€‰æ‹©å™¨">é€‰æ‹©å™¨</h4>
<p>åœ¨è§„åˆ™å£°æ˜ä¸­ï¼Œâ€œé€‰æ‹©å™¨â€ è´Ÿè´£é€‰å– DOM æ ‘ä¸­çš„å…ƒç´ ï¼Œè¿™äº›å…ƒç´ å°†è¢«å®šä¹‰çš„å±æ€§æ‰€ä¿®é¥°ã€‚é€‰æ‹©å™¨å¯ä»¥åŒ¹é… HTML å…ƒç´ ï¼Œä¹Ÿå¯ä»¥åŒ¹é…ä¸€ä¸ªå…ƒç´ çš„ç±»åã€ID, æˆ–è€…å…ƒç´ æ‹¥æœ‰çš„å±æ€§ã€‚ä»¥ä¸‹æ˜¯é€‰æ‹©å™¨çš„ä¾‹å­ï¼š</p>
<pre><code class="language-css">.my-element-class {
  /* ... */
}

[aria-hidden] {
  /* ... */
}
</code></pre>
<h4 id="å±æ€§">å±æ€§</h4>
<p>æœ€åï¼Œå±æ€§å†³å®šäº†è§„åˆ™å£°æ˜é‡Œè¢«é€‰æ‹©çš„å…ƒç´ å°†å¾—åˆ°ä½•ç§æ ·å¼ã€‚å±æ€§ä»¥é”®å€¼å¯¹å½¢å¼å­˜åœ¨ï¼Œä¸€ä¸ªè§„åˆ™å£°æ˜å¯ä»¥åŒ…å«ä¸€æˆ–å¤šä¸ªå±æ€§å®šä¹‰ã€‚ä»¥ä¸‹æ˜¯å±æ€§å®šä¹‰çš„ä¾‹å­ï¼š</p>
<pre><code class="language-css">/* some selector */ {
  background: #f1f1f1;
  color: #333;
}
</code></pre>
<h3 id="cssæ ¼å¼">CSSæ ¼å¼</h3>
<ul>
<li>ä½¿ç”¨ 2 ä¸ªç©ºæ ¼ä½œä¸ºç¼©è¿›ã€‚</li>
<li>ç±»åå»ºè®®ä½¿ç”¨ç ´æŠ˜å·ä»£æ›¿é©¼å³°æ³•ã€‚å¦‚æœä½ ä½¿ç”¨ BEMï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹åˆ’çº¿ï¼ˆå‚è§ä¸‹é¢çš„ <a href="#oocss-and-bem">OOCSS å’Œ BEM</a>ï¼‰ã€‚</li>
<li>ä¸è¦ä½¿ç”¨ ID é€‰æ‹©å™¨ã€‚</li>
<li>åœ¨ä¸€ä¸ªè§„åˆ™å£°æ˜ä¸­åº”ç”¨äº†å¤šä¸ªé€‰æ‹©å™¨æ—¶ï¼Œæ¯ä¸ªé€‰æ‹©å™¨ç‹¬å ä¸€è¡Œã€‚</li>
<li>åœ¨è§„åˆ™å£°æ˜çš„å·¦å¤§æ‹¬å· { å‰åŠ ä¸Šä¸€ä¸ªç©ºæ ¼ã€‚</li>
<li>åœ¨å±æ€§çš„å†’å· : åé¢åŠ ä¸Šä¸€ä¸ªç©ºæ ¼ï¼Œå‰é¢ä¸åŠ ç©ºæ ¼ã€‚</li>
<li>è§„åˆ™å£°æ˜çš„å³å¤§æ‹¬å· } ç‹¬å ä¸€è¡Œã€‚</li>
<li>è§„åˆ™å£°æ˜ä¹‹é—´ç”¨ç©ºè¡Œåˆ†éš”å¼€ã€‚</li>
</ul>
<h4 id="bad">Bad</h4>
<pre><code class="language-css">.avatar{
    border-radius:50%;
    border:2px solid white; }
.no, .nope, .not_good {
    // ...
}
#lol-no {
  // ...
}
</code></pre>
<h4 id="good">Good</h4>
<pre><code class="language-css">.avatar {
  border-radius: 50%;
  border: 2px solid white;
}

.one,
.selector,
.per-line {
  // ...
}
</code></pre>
<h3 id="æ³¨é‡Š">æ³¨é‡Š</h3>
<ul>
<li>å»ºè®®ä½¿ç”¨è¡Œæ³¨é‡Š (åœ¨ Sass ä¸­æ˜¯ //) ä»£æ›¿å—æ³¨é‡Šã€‚</li>
<li>å»ºè®®æ³¨é‡Šç‹¬å ä¸€è¡Œã€‚é¿å…è¡Œæœ«æ³¨é‡Šã€‚</li>
<li>ç»™æ²¡æœ‰è‡ªæ³¨é‡Šçš„ä»£ç å†™ä¸Šè¯¦ç»†è¯´æ˜ï¼Œæ¯”å¦‚ï¼š<br>
ä¸ºä»€ä¹ˆç”¨åˆ°äº† z-index<br>
å…¼å®¹æ€§å¤„ç†æˆ–è€…é’ˆå¯¹ç‰¹å®šæµè§ˆå™¨çš„ hack</li>
</ul>
<h3 id="id-é€‰æ‹©å™¨">ID é€‰æ‹©å™¨</h3>
<p>åœ¨ CSS ä¸­ï¼Œè™½ç„¶å¯ä»¥é€šè¿‡ ID é€‰æ‹©å…ƒç´ ï¼Œä½†å¤§å®¶é€šå¸¸éƒ½ä¼šæŠŠè¿™ç§æ–¹å¼åˆ—ä¸ºåé¢æ•™æã€‚ID é€‰æ‹©å™¨ç»™ä½ çš„è§„åˆ™å£°æ˜å¸¦æ¥äº†ä¸å¿…è¦çš„é«˜ä¼˜å…ˆçº§ï¼Œè€Œä¸” ID é€‰æ‹©å™¨æ˜¯ä¸å¯é‡ç”¨çš„ã€‚</p>
<p>æƒ³è¦äº†è§£å…³äºè¿™ä¸ªä¸»é¢˜çš„æ›´å¤šå†…å®¹ï¼Œå‚è§ <a href="https://csswizardry.com/2014/07/hacks-for-dealing-with-specificity/">CSS Wizardry</a> çš„æ–‡ç« ï¼Œæ–‡ç« ä¸­æœ‰å…³äºå¦‚ä½•å¤„ç†ä¼˜å…ˆçº§çš„å†…å®¹ã€‚</p>
<h3 id="javascript-é’©å­">JavaScript é’©å­</h3>
<p>é¿å…åœ¨ CSS å’Œ JavaScript ä¸­ç»‘å®šç›¸åŒçš„ç±»ã€‚å¦åˆ™å¼€å‘è€…åœ¨é‡æ„æ—¶é€šå¸¸ä¼šå‡ºç°ä»¥ä¸‹æƒ…å†µï¼šè½»åˆ™æµªè´¹æ—¶é—´åœ¨å¯¹ç…§æŸ¥æ‰¾æ¯ä¸ªè¦æ”¹å˜çš„ç±»ï¼Œé‡åˆ™å› ä¸ºå®³æ€•ç ´ååŠŸèƒ½è€Œä¸æ•¢ä½œå‡ºæ›´æ”¹ã€‚</p>
<p>æˆ‘ä»¬æ¨èåœ¨åˆ›å»ºç”¨äºç‰¹å®š JavaScript çš„ç±»åæ—¶ï¼Œæ·»åŠ  .js- å‰ç¼€ï¼š</p>
<pre><code class="language-html">&lt;button class=&quot;btn btn-primary js-request-to-book&quot;&gt;Request to Book&lt;/button&gt;
</code></pre>
<h3 id="è¾¹æ¡†">è¾¹æ¡†</h3>
<p>åœ¨å®šä¹‰æ— è¾¹æ¡†æ ·å¼æ—¶ï¼Œä½¿ç”¨ 0 ä»£æ›¿ noneã€‚</p>
<h4 id="bad-2">Bad</h4>
<pre><code class="language-css">.foo {
  border: none;
}
</code></pre>
<h4 id="good-2">Good</h4>
<pre><code class="language-css">.foo {
  border: 0;
}
</code></pre>
<h3 id="sass">Sass</h3>
<p>è¯­æ³•<br>
ä½¿ç”¨ .scss çš„è¯­æ³•ï¼Œä¸ä½¿ç”¨ .sass åŸæœ¬çš„è¯­æ³•ã€‚<br>
CSS å’Œ @include å£°æ˜æŒ‰ç…§ä»¥ä¸‹é€»è¾‘æ’åºï¼ˆå‚è§ä¸‹æ–‡ï¼‰</p>
<pre><code class="language-html">&lt;a name=&quot;ordering-of-property-declarations&quot;&gt;&lt;/a&gt;
</code></pre>
<h3 id="å±æ€§å£°æ˜çš„æ’åº">å±æ€§å£°æ˜çš„æ’åº</h3>
<h4 id="å±æ€§å£°æ˜">å±æ€§å£°æ˜</h4>
<p>é¦–å…ˆåˆ—å‡ºé™¤å» @include å’ŒåµŒå¥—é€‰æ‹©å™¨ä¹‹å¤–çš„æ‰€æœ‰å±æ€§å£°æ˜ã€‚</p>
<p><code>.btn-green { background: green; font-weight: bold; // ... }</code></p>
<h4 id="include-å£°æ˜">@include å£°æ˜</h4>
<p>ç´§éšåé¢çš„æ˜¯ @includeï¼Œè¿™æ ·å¯ä»¥ä½¿å¾—æ•´ä¸ªé€‰æ‹©å™¨çš„å¯è¯»æ€§æ›´é«˜ã€‚</p>
<p><code>.btn-green { background: green; font-weight: bold; @include transition(background 0.5s ease); // ... }</code></p>
<h4 id="åµŒå¥—é€‰æ‹©å™¨">åµŒå¥—é€‰æ‹©å™¨</h4>
<p>_å¦‚æœæœ‰å¿…è¦_ç”¨åˆ°åµŒå¥—é€‰æ‹©å™¨ï¼ŒæŠŠå®ƒä»¬æ”¾åˆ°æœ€åï¼Œåœ¨è§„åˆ™å£°æ˜å’ŒåµŒå¥—é€‰æ‹©å™¨ä¹‹é—´è¦åŠ ä¸Šç©ºç™½ï¼Œç›¸é‚»åµŒå¥—é€‰æ‹©å™¨ä¹‹é—´ä¹Ÿè¦åŠ ä¸Šç©ºç™½ã€‚åµŒå¥—é€‰æ‹©å™¨ä¸­çš„å†…å®¹ä¹Ÿè¦éµå¾ªä¸Šè¿°æŒ‡å¼•ã€‚</p>
<p>` .btn { background: green; font-weight: bold; @include transition(background 0.5s ease);</p>
<p>.icon { margin-right: 10px; } } `</p>
<h3 id="å˜é‡">å˜é‡</h3>
<p>å˜é‡ååº”ä½¿ç”¨ç ´æŠ˜å·ï¼ˆä¾‹å¦‚ $my-variableï¼‰ä»£æ›¿ camelCased å’Œ snake_cased é£æ ¼ã€‚å¯¹äºä»…ç”¨åœ¨å½“å‰æ–‡ä»¶çš„å˜é‡ï¼Œå¯ä»¥åœ¨å˜é‡åä¹‹å‰æ·»åŠ ä¸‹åˆ’çº¿å‰ç¼€ï¼ˆä¾‹å¦‚ $_my-variableï¼‰ã€‚</p>
<h3 id="mixins">Mixins</h3>
<p>ä¸ºäº†è®©ä»£ç éµå¾ª DRY åŸåˆ™ï¼ˆDon't Repeat Yourselfï¼‰ã€å¢å¼ºæ¸…æ™°æ€§æˆ–æŠ½è±¡åŒ–å¤æ‚æ€§ï¼Œåº”è¯¥ä½¿ç”¨ mixinï¼Œè¿™ä¸é‚£äº›å‘½åè‰¯å¥½çš„å‡½æ•°çš„ä½œç”¨æ˜¯å¼‚æ›²åŒå·¥çš„ã€‚è™½ç„¶ mixin å¯ä»¥ä¸æ¥æ”¶å‚æ•°ï¼Œä½†è¦æ³¨æ„ï¼Œå‡å¦‚ä½ ä¸å‹ç¼©è´Ÿè½½ï¼ˆæ¯”å¦‚é€šè¿‡ gzipï¼‰ï¼Œè¿™æ ·ä¼šå¯¼è‡´æœ€ç»ˆçš„æ ·å¼åŒ…å«ä¸å¿…è¦çš„ä»£ç é‡å¤ã€‚</p>
<h3 id="æ‰©å±•æŒ‡ä»¤">æ‰©å±•æŒ‡ä»¤</h3>
<p>åº”é¿å…ä½¿ç”¨ @extend æŒ‡ä»¤ï¼Œå› ä¸ºå®ƒå¹¶ä¸ç›´è§‚ï¼Œè€Œä¸”å…·æœ‰æ½œåœ¨é£é™©ï¼Œç‰¹åˆ«æ˜¯ç”¨åœ¨åµŒå¥—é€‰æ‹©å™¨çš„æ—¶å€™ã€‚å³ä¾¿æ˜¯åœ¨é¡¶å±‚å ä½ç¬¦é€‰æ‹©å™¨ä½¿ç”¨æ‰©å±•ï¼Œå¦‚æœé€‰æ‹©å™¨çš„é¡ºåºæœ€ç»ˆä¼šæ”¹å˜ï¼Œä¹Ÿå¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ã€‚ï¼ˆæ¯”å¦‚ï¼Œå¦‚æœå®ƒä»¬å­˜åœ¨äºå…¶ä»–æ–‡ä»¶ï¼Œè€ŒåŠ è½½é¡ºåºå‘ç”Ÿäº†å˜åŒ–ï¼‰ã€‚å…¶å®ï¼Œä½¿ç”¨ @extend æ‰€è·å¾—çš„å¤§éƒ¨åˆ†ä¼˜åŒ–æ•ˆæœï¼Œgzip å‹ç¼©å·²ç»å¸®åŠ©ä½ åšåˆ°äº†ï¼Œå› æ­¤ä½ åªéœ€è¦é€šè¿‡ mixin è®©æ ·å¼è¡¨æ›´ç¬¦åˆ DRY åŸåˆ™å°±è¶³å¤Ÿäº†ã€‚</p>
<h3 id="åµŒå¥—é€‰æ‹©å™¨-2">åµŒå¥—é€‰æ‹©å™¨</h3>
<p>è¯·ä¸è¦è®©åµŒå¥—é€‰æ‹©å™¨çš„æ·±åº¦è¶…è¿‡ 3 å±‚ï¼</p>
<pre><code class="language-sass">.page-container {
  .content {
    .profile {
      // STOP!
    }
  }
}
</code></pre>
<p>å½“é‡åˆ°ä»¥ä¸Šæƒ…å†µçš„æ—¶å€™ï¼Œä½ ä¹Ÿè®¸æ˜¯è¿™æ ·å†™ CSS çš„ï¼š</p>
<ul>
<li>ä¸ HTML å¼ºè€¦åˆçš„ï¼ˆä¹Ÿæ˜¯è„†å¼±çš„ï¼‰<em>â€”æˆ–è€…â€”</em></li>
<li>è¿‡äºå…·ä½“ï¼ˆå¼ºå¤§ï¼‰<em>â€”æˆ–è€…â€”</em></li>
<li>æ²¡æœ‰é‡ç”¨</li>
</ul>
<h5 id="å†è¯´ä¸€é-æ°¸è¿œä¸è¦åµŒå¥—-id-é€‰æ‹©å™¨-æ°¸è¿œä¸è¦åµŒå¥—-id-é€‰æ‹©å™¨-æ°¸è¿œä¸è¦åµŒå¥—-id-é€‰æ‹©å™¨">å†è¯´ä¸€é: æ°¸è¿œä¸è¦åµŒå¥— ID é€‰æ‹©å™¨ï¼ æ°¸è¿œä¸è¦åµŒå¥— ID é€‰æ‹©å™¨ï¼ æ°¸è¿œä¸è¦åµŒå¥— ID é€‰æ‹©å™¨ï¼</h5>
<p>å¦‚æœä½ å§‹ç»ˆåšæŒè¦ä½¿ç”¨ ID é€‰æ‹©å™¨ï¼ˆåŠä½ ä¸‰æ€ï¼‰ï¼Œé‚£ä¹Ÿä¸åº”è¯¥åµŒå¥—å®ƒä»¬ã€‚å¦‚æœä½ æ­£æ‰“ç®—è¿™ä¹ˆåšï¼Œä½ éœ€è¦å…ˆé‡æ–°æ£€æŸ¥ä½ çš„æ ‡ç­¾ï¼Œæˆ–è€…æŒ‡æ˜åŸå› ã€‚å¦‚æœä½ æƒ³è¦å†™å‡ºé£æ ¼è‰¯å¥½çš„ HTML å’Œ CSSï¼Œä½ æ˜¯ä¸åº”è¯¥è¿™æ ·åšçš„ã€‚</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[å‰ç«¯å¸¸ç”¨çš„å‘½åè§„èŒƒ]]></title>
        <id>https://weidadeda.github.io/post/qian-duan-chang-yong-de-ming-ming-gui-fan</id>
        <link href="https://weidadeda.github.io/post/qian-duan-chang-yong-de-ming-ming-gui-fan">
        </link>
        <updated>2021-12-20T11:20:48.000Z</updated>
        <content type="html"><![CDATA[<ul>
<li>ç›®å½• å…¨å°å†™ä¸­åˆ’çº¿</li>
<li>æ–‡ä»¶ å…¨å°å†™ä¸­åˆ’çº¿</li>
<li>ç±»å å¤§é©¼å³°</li>
<li>å˜é‡ å°é©¼å³°</li>
<li>å¸¸é‡ å…¨å¤§å†™ ä¸‹åˆ’çº¿é£æ ¼</li>
<li>ç‰¹æ®Šå˜é‡</li>
<li>cssç±»å å°å†™ä¸­åˆ’çº¿</li>
<li>å•è¯æ‹¼éŸ³ä¸å…è®¸</li>
<li>å¤æ‚å‡½æ•°å’Œå…¬ç”¨å‡½æ•°å¿…é¡»åŠ æ³¨é‡Š</li>
<li>å‡½æ•°çš„å‚æ•°æœ€å¤šä¸èƒ½è¶…è¿‡ä¸‰ä¸ª</li>
<li>url å…¨å°å†™ ä¸­åˆ’çº¿</li>
</ul>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç€‘å¸ƒæµè®¡ç®—jsæºç ]]></title>
        <id>https://weidadeda.github.io/post/pu-bu-liu-ji-suan-js-yuan-ma</id>
        <link href="https://weidadeda.github.io/post/pu-bu-liu-ji-suan-js-yuan-ma">
        </link>
        <updated>2021-11-24T14:38:44.000Z</updated>
        <content type="html"><![CDATA[<p>é‡åˆ°é—®é¢˜æ—¶çš„è§£å†³æ–¹æ³•åŠä½¿ç”¨æ³¨æ„äº‹é¡¹ï¼š</p>
<p>1ã€ä¸‹æ‹‰åˆ·æ–°ä¼šå¯¼è‡´ç€‘å¸ƒæµé¡ºåºé”™ä¹±ï¼Œé‡æ–°newä¸€ä¸‹ç€‘å¸ƒæµå³å¯ã€‚</p>
<p>2ã€å›¾ç‰‡å®½é«˜å¿…é¡»è¦è®©æœåŠ¡ç«¯è¿”ï¼Œå‰ç«¯å»è·å–æ•°æ®å¤ªå¤šä¼šå¯¼è‡´æ€§èƒ½éå¸¸æ…¢ã€‚</p>
<p>3ã€domåŠ è½½æ—¶è·å–å°ç¨‹åºçš„æŸä¸ªdomçš„å®½åº¦ï¼ˆåˆ—å®½ï¼‰ä¸ºç©ºï¼Œæ”¾åœ¨wx.nextTickä¸­å³å¯ã€‚è¿˜è·å–ä¸åˆ°ï¼Œå°±éœ€è¦çœ‹è‡ªå·±è¦è·å–çš„domæ˜¯å¦å·²åŠ è½½ã€‚</p>
<p>4ã€æ­¤ä»£ç æŠ—æï¼Œå¦‚æœå‡ºé—®é¢˜å…ˆä»è‡ªèº«æ‰¾é—®é¢˜ï¼Œå†ä»”ç»†é˜…è¯»ä¸€éæ­¤ä»£ç ã€‚</p>
<pre><code>class Waterfall {
  constructor(options) {
    this.initWaterfall(options);
  }
    /**
   * åˆå§‹åŒ–ç€‘å¸ƒæµ
   * @param {Object} options
   * @param {Array&lt;Object&gt;} options.columns {width} - æ­¤å‚æ•°ä¸»è¦å®šä¹‰æ¯åˆ—çš„å®½åº¦
   */
  initWaterfall(options) {
    this.columns = options.columns;
    this.formatedData = [];
    for (let column of options.columns) {
      this.formatedData.push({
        width: column.width,
        height: 0
      });
    }
  }
  imageUrlFeild = 'imageUrl'
 
  /**
   * æ ¼å¼åŒ–ä»æ•°æ®ä¸­è·å–å›¾ç‰‡urlçš„æ–¹æ³•
   * @param {Function | String | Number} fn - è‹¥ä¸ºå‡½æ•°ï¼Œåˆ™éœ€è¦è¿”å›ç€‘å¸ƒæµæ¯é¡¹æ•°æ®å¯¹åº”çš„å›¾ç‰‡å­—æ®µ
   */
 
  formatGetImageUrlMethod(fn) {
    this.imageUrlFeild = typeof fn === 'function' ? fn() : fn
  }
 
  /**
   * å‘ç€‘å¸ƒæµä¸­å¡«å……æ•°æ®
   * @param {Object}  resource - å•ä¸ªç€‘å¸ƒæµé¡¹çš„æ•°æ®æº
   */
  getResourceInfo(resource) {
    const _self = this
    return new Promise(resolve =&gt; {
      if (resource[_self.imageUrlFeild]) {
        // getImageInfoæ–¹æ³•åœ¨å°ç¨‹åºä¸­ä½¿ç”¨ï¼Œh5ä¸­æš‚æœªæµ‹è¯•ï¼Œä¸è¿‡ä¸€èˆ¬éƒ½æ˜¯è®©æœåŠ¡ç«¯ç›´æ¥è¿”å›å›¾ç‰‡å®½é«˜ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¸€èˆ¬ç”¨ä¸åˆ°ï¼Œå¦‚æœéœ€è¦ç”¨åˆ°çš„è¯ï¼Œå¿…é¡»åŠ ä¸€å±‚loadingé˜»æ­¢ç”¨æˆ·æ“ä½œ
        wx.getImageInfo({
          src: resource[_self.imageUrlFeild],
          success(res) {
            resolve(res)
          },
          fail() {
            resolve()
          }
        })
      } else {
        resolve()
      }
    })
  }
 
  /**
   * å‘ç€‘å¸ƒæµä¸­è¡¥å……æ•°æ®
   * @param {Boolean} extraVal ç€‘å¸ƒæµçš„å¡ç‰‡ä¸­å›¾ç‰‡ä¹‹å¤–çš„å†…å®¹
   * @param {Array&lt;resource&gt;}  resources
   */
 
  async addResources(resources, extraVal) {
    // let promiseArray = []
    let newResourcesArray = Array.apply(null, Array(this.columns.length)).map(
      _ =&gt; []
    )
    for (let resource of resources) {
      // promiseArray.push(this.getResourceInfo(resource))
      // let imageInfo
      // imageInfo = await this.getResourceInfo(resource)
      const width = Number(resource.width) || 100;
      const height = Number(resource.height) || 100;
      // è·å–æœ€çŸ­åˆ—çš„ç´¢å¼•
      const index = this.getShortestColumn();
      // å¡ç‰‡å®½åº¦
      const imageWidth = this.formatedData[index].width;
      // é™„åŠ çš„å¡ç‰‡é«˜åº¦åœ¨è¿™é‡Œæ˜¯å†™æ­»çš„ï¼Œæ¯ä¸ªé¡¹ç›®ä¼šæœ‰ä¸åŒé«˜åº¦
      const extraHeight = extraVal ? extraVal : 0;
      // è·å–å¡ç‰‡é«˜åº¦
      const cardHeight = imageWidth / (width / height) + extraHeight;
      // å½“å‰åˆ—æ€»é«˜åº¦
      this.formatedData[index].height += cardHeight;
      // è¿”å›å¡ç‰‡é«˜åº¦
      resource.cardHeight = cardHeight;
      // è¿”å›å›¾ç‰‡é«˜åº¦
      resource.computedHeight = cardHeight - extraVal;
      // è¿”å›å½“å‰åˆ—çš„æ•°ç»„
      newResourcesArray[index].push(resource);
    }
    return newResourcesArray
  }
 
  /**
   * æœ€é‡è¦çš„åœ°æ–¹
   * è·å–å½“å‰æ•°æ®ä¸­å¡«å……æœ€çŸ­çš„åˆ—
   * è¿”å›æœ€çŸ­åˆ—çš„ç´¢å¼•
   */
  getShortestColumn() {
    let minHeight = Infinity
    let minHeightColumnIndex = 0
    for (let index = this.formatedData.length - 1; index &gt; -1; index--) {
      //ä»åå¾€å‰éå†ï¼Œé˜²æ­¢æ¯åˆ—çš„é«˜åº¦ç›¸åŒçš„æƒ…å†µ
      const height = this.formatedData[index].height
      if (height &lt;= minHeight) {
        minHeightColumnIndex = index
        minHeight = height
      }
    }
    return minHeightColumnIndex
  }
}
 
export default Waterfall;
 
 
// ä¾‹ï¼šåŒåˆ—ç€‘å¸ƒæµ
let newList = new Waterfall({
      columns: [
        {
          width: åˆ—å®½
        },
        {
          width: åˆ—å®½
        }
      ]
    });
newList.addResources(lists, å¡ç‰‡å†…é™¤å›¾ç‰‡çš„é¢å¤–é«˜åº¦).then(res =&gt; {});
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Taro å°ç¨‹åºç›´æ’­ç»„ä»¶ LivePlayer æ³¨æ„äº‹é¡¹]]></title>
        <id>https://weidadeda.github.io/post/taro-xiao-cheng-xu-zhi-bo-zu-jian-liveplayer-zhu-yi-shi-xiang</id>
        <link href="https://weidadeda.github.io/post/taro-xiao-cheng-xu-zhi-bo-zu-jian-liveplayer-zhu-yi-shi-xiang">
        </link>
        <updated>2021-11-15T13:49:16.000Z</updated>
        <content type="html"><![CDATA[<h3 id="1-ç›´æ’­ç»„ä»¶ä¼˜å…ˆå¼€é€šå®æ—¶éŸ³é¢‘å’Œè§†é¢‘ç®¡ç†åå°ç”³è¯·å¯¹åº”çš„è¯ä¹¦">1ã€ç›´æ’­ç»„ä»¶ä¼˜å…ˆå¼€é€šå®æ—¶éŸ³é¢‘å’Œè§†é¢‘ï¼ˆç®¡ç†åå°ï¼‰ï¼Œç”³è¯·å¯¹åº”çš„è¯ä¹¦</h3>
<h3 id="2-ç›´æ’­ç»„ä»¶éœ€è¦åšç³»ç»Ÿæƒé™éªŒè¯éº¦å…‹é£å’Œç›¸æœºå¼•å¯¼ç”¨æˆ·æ‰“å¼€æƒé™ä¸ç„¶éƒ¨åˆ†æ‰‹æœºåŠ è½½å¤±è´¥-insertliveplayerfailaccess-denied-å› ä¸ºæƒé™æœ‰ä¸‰ä¸ªçŠ¶æ€undefined-denied-authorizedauthorizedä»£è¡¨ç³»ç»Ÿæƒé™å·²å¼€">2ã€ç›´æ’­ç»„ä»¶éœ€è¦åšã€ç³»ç»Ÿã€‘æƒé™éªŒè¯ï¼Œï¼ˆéº¦å…‹é£å’Œç›¸æœºï¼‰,å¼•å¯¼ç”¨æˆ·æ‰“å¼€æƒé™ï¼Œä¸ç„¶éƒ¨åˆ†æ‰‹æœºåŠ è½½å¤±è´¥ï¼ˆ insertLivePlayer:fail:access deniedï¼‰ å› ä¸ºæƒé™æœ‰ä¸‰ä¸ªçŠ¶æ€(undefinedã€deniedã€authorized)ï¼Œauthorizedä»£è¡¨ç³»ç»Ÿæƒé™å·²å¼€</h3>
<pre><code>export const getSystemInfo = (keys: Tkey[], content = '') =&gt; {
  return new Promise((resolve) =&gt; {
    const systemInfo = wx.getAppAuthorizeSetting();
    console.log('system', systemInfo);
    if (!systemInfo) {
      return resolve({ code: -1, msg: 'è·å–ç³»ç»Ÿæƒé™å¤±è´¥~' });
    }
    keys.forEach((item) =&gt; {
      if (systemInfo[item] !== 'authorized') {
        Taro.showModal({
          content,
          success: (res) =&gt; {
            if (res.confirm) {
              wx.openAppAuthorizeSetting({
                success: () =&gt; {
                  return resolve({ code: 100, msg: 'æ‰“å¼€ç³»ç»Ÿæˆæƒé¡µæˆåŠŸ~' });
                },
                fail: () =&gt; {
                  return resolve({ code: 101, msg: 'æ‰“å¼€ç³»ç»Ÿæˆæƒé¡µå¤±è´¥~' });
                }
              });
            } else {
              return resolve({ code: 403, msg: 'ç”¨æˆ·ç‚¹å‡»å–æ¶ˆ~' });
            }
          }
        });
        return resolve({ code: 401, msg: 'æƒé™æ²¡æ‰“å¼€~' });
      }
    });
    return resolve({ code: 0, msg: 'ç”¨æˆ·å·²å¼€é€šå¯¹åº”æƒé™~' });
  });
};
 
// è·å–ç³»ç»Ÿæƒé™
      const res: any = await getSystemInfo(
        ['cameraAuthorized', 'microphoneAuthorized'],
        'æ£€æµ‹åˆ°æ‚¨æ²¡æœ‰æ‰“å¼€éº¦å…‹é£å’Œç›¸æœºæƒé™ï¼Œéƒ¨åˆ†åŠŸèƒ½å°†æ²¡æ³•ä½¿ç”¨~'
      );
</code></pre>
<h3 id="3-ç›´æ’­ç»„ä»¶åŒå±‚æ¸²æŸ“åœ¨å…¨å±ä¸‹å¤±æ•ˆéœ€è¦å•ç‹¬å¤„ç†å…¨å±åšcoverviewcoverimageåšåŸç”Ÿè¦†ç›–èƒ½åŠ›å¤„ç†ä¸æ˜¯å…¨å±å°±åŒå±‚æ¸²æŸ“å…¨å±å¤„ç†æ—¶å€™é¡¶å±‚å®¹å™¨å’Œç›´æ¥å­èŠ‚ç‚¹éœ€è¦è®¾ç½®-visiblityvisiblepositionrelativez-index99999-å¿…é¡»å¾—å¤„ç†ä¸ç„¶android-çš„coverviewè¦†ç›–ä¸äº†åŸç”Ÿç›´æ’­ç»„ä»¶">3ã€ç›´æ’­ç»„ä»¶åŒå±‚æ¸²æŸ“åœ¨å…¨å±ä¸‹å¤±æ•ˆï¼Œéœ€è¦å•ç‹¬å¤„ç†ï¼Œå…¨å±åšCoverView\CoverImageåšåŸç”Ÿè¦†ç›–èƒ½åŠ›å¤„ç†ï¼Œä¸æ˜¯å…¨å±å°±åŒå±‚æ¸²æŸ“ï¼Œå…¨å±å¤„ç†æ—¶å€™é¡¶å±‚å®¹å™¨å’Œç›´æ¥å­èŠ‚ç‚¹éœ€è¦è®¾ç½® visiblity:visible;position:relative;z-index:99999; å¿…é¡»å¾—å¤„ç†ï¼Œä¸ç„¶android çš„CoverViewè¦†ç›–ä¸äº†åŸç”Ÿç›´æ’­ç»„ä»¶ã€‚</h3>
<pre><code>.cover-main{
    position: absolute;
    visibility: visible;
    z-index: 999999;
}
 
&lt;CoverView className={style['cover-main']}&gt;
                &lt;CoverView className={style['cover-main']}&gt;
                  &lt;CoverView className={style['live-control']} onClick={showTips}&gt;&lt;/CoverView&gt;
 
        {fullScreenFlag &amp;&amp; (
        &lt;&gt;
            {/*å¹¿å‘Š*/}
            &lt;Curtain /&gt;

            {/* å°é¢*/}
            {startStatus === false ? (
            &lt;CoverView className={style.cannot_see}&gt;
                &lt;CoverImage className={style.cannot_see_img} src={readyImg}&gt;&lt;/CoverImage&gt;
            &lt;/CoverView&gt;
            ) : teachStatus === false ? (
            &lt;CoverView className={style.cannot_see}&gt;
                &lt;CoverImage className={style.cannot_see_img} src={outImg}&gt;&lt;/CoverImage&gt;
            &lt;/CoverView&gt;
            ) : null}

            {/* å€’è®¡æ—¶*/}
            {time &gt;= 1800 ? &lt;CountDown time={time} /&gt; : null}
        &lt;/&gt;
        )}

        {/*æ§åˆ¶*/}
        &lt;CoverView
        className={`${style.control} ${tips ? style['up-ani'] : style['down-ani']}`}
        &gt;
        &lt;CoverView className={style.info}&gt;
            &lt;CoverView&gt;ç›´æ’­&lt;/CoverView&gt;
        &lt;/CoverView&gt;
        &lt;CoverView className={style['full-screen']} onClick={handleFullScreen}&gt;
            &lt;CoverImage
            className={style.icon}
            src={fullScreenFlag ? tuichuquanping : quanping}
            &gt;&lt;/CoverImage&gt;
            &lt;CoverView&gt;{fullScreenFlag ? 'å°å±æ’­æ”¾' : 'å…¨å±æ’­æ”¾'}&lt;/CoverView&gt;
        &lt;/CoverView&gt;
        &lt;/CoverView&gt;
    &lt;/CoverView&gt;
    &lt;/CoverView&gt;
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[ç”¨yeomanå¼€å‘ä¸€ä¸ªè‡ªå·±çš„é¡¹ç›®è„šæ‰‹æ¶]]></title>
        <id>https://weidadeda.github.io/post/kai-fa-yi-ge-zi-ji-de-xiang-mu-jiao-shou-jia</id>
        <link href="https://weidadeda.github.io/post/kai-fa-yi-ge-zi-ji-de-xiang-mu-jiao-shou-jia">
        </link>
        <updated>2021-10-19T12:37:02.000Z</updated>
        <content type="html"><![CDATA[<p><img src="https://weidadeda.github.io/post-images/1644219568486.gif" alt="" loading="lazy"><br>
ä¸Šé¢æ˜¯ä¸€ä¸ªä½¿ç”¨è„šæ‰‹æ¶æ¥åˆå§‹åŒ–é¡¹ç›®çš„å…¸å‹ä¾‹å­ã€‚<br>
éšç€å‰ç«¯å·¥ç¨‹åŒ–çš„ç†å¿µä¸æ–­æ·±å…¥ï¼Œè¶Šæ¥è¶Šå¤šçš„äººé€‰æ‹©ä½¿ç”¨è„šæ‰‹æ¶æ¥ä»é›¶åˆ°ä¸€æ­å»ºè‡ªå·±çš„é¡¹ç›®ã€‚å…¶ä¸­å¤§å®¶æœ€ç†Ÿæ‚‰çš„å°±æ˜¯create-react-appå’Œvue-cliï¼Œå®ƒä»¬å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆå§‹åŒ–é…ç½®ã€ç”Ÿæˆé¡¹ç›®ç»“æ„ã€è‡ªåŠ¨å®‰è£…ä¾èµ–ï¼Œæœ€åæˆ‘ä»¬ä¸€è¡ŒæŒ‡ä»¤å³å¯è¿è¡Œé¡¹ç›®å¼€å§‹å¼€å‘ï¼Œæˆ–è€…è¿›è¡Œé¡¹ç›®æ„å»ºï¼ˆbuildï¼‰ã€‚<br>
è¿™äº›è„šæ‰‹æ¶æä¾›çš„éƒ½æ˜¯æ™®éæ„ä¹‰ä¸Šçš„æœ€ä½³å®è·µï¼Œä½†æ˜¯æˆ‘åœ¨å¼€å‘ä¸­å‘ç°ï¼Œéšç€ä¸šåŠ¡çš„ä¸æ–­å‘å±•ï¼Œå¿…ç„¶ä¼šå‡ºç°éœ€è¦é’ˆå¯¹ä¸šåŠ¡å¼€å‘çš„å®é™…æƒ…å†µæ¥è¿›è¡Œè°ƒæ•´ã€‚ä¾‹å¦‚ï¼š</p>
<ol>
<li>
<p>é¡¹ç›®æ¶æ„çš„é…ç½®<br>
a. webpack/gulpçš„é…ç½®<br>
â…°. style/less/sassçš„é€‰æ‹©å’Œå¤„ç†é…ç½®ã€‚<br>
â…±. Typescriptå’ŒJavaScriptçš„loaderå’Œbabelçš„é…ç½®ï¼Œæ¯”å¦‚babel-loaderå’Œtscã€‚<br>
â…². å›¾ç‰‡çš„é…ç½®ï¼Œæ¯”å¦‚éœ€è¦file-loaderæˆ–è€…url-loaderã€‚<br>
â…³. é™æ€èµ„æºçš„é…ç½®ã€‚<br>
â…´. ä¼ä¸šå†…éƒ¨ï¼ŒçœŸå¯¹äºæŸäº›ç‰¹å®šåŠŸèƒ½çš„webpack-loader/webpack-pluginï¼Œæ¯”å¦‚æ‰“åŒ…å®Œå›¾ç‰‡ä¸Šä¼ ã€‚<br>
b. æ˜¯å¦å†…ç½®ä¸€äº›ç¬¬ä¸‰æ–¹æ¡†æ¶ä¾›ä¸Šæ‰‹ä½¿ç”¨ï¼Œæ¯”å¦‚Element-UIï¼ŒAntdç­‰ã€‚<br>
c. é¡¹ç›®çš„è·¯ç”±çš„è®¾è®¡å’Œé…ç½®ã€‚<br>
d. é¡¹ç›®ç›®å½•ç»“æ„çš„è®¾è®¡å’Œé…ç½®ã€‚<br>
e. é¡¹ç›®é€šç”¨åŠŸèƒ½çš„æœ‰å…³ä»£ç ï¼Œæ¯”å¦‚ç™»é™†å’Œæ¬¢è¿é¡µç­‰ã€‚<br>
f.é€šè¿‡è°ƒæ•´æ’ä»¶ä¸é…ç½®å®ç° Webpack æ‰“åŒ…æ€§èƒ½ä¼˜åŒ–<br>
g.é’ˆå¯¹ç”Ÿäº§ç¯å¢ƒåšçš„å•ç‹¬å¤„ç†</p>
</li>
<li>
<p>é¡¹ç›®å¼€å‘ä¸­çš„é…ç½®<br>
a. eslintã€‚<br>
b. style-lintã€‚<br>
c. prettierã€‚<br>
d. å•å…ƒæµ‹è¯•jestæˆ–è€…å…¶ä»–å•å…ƒæµ‹è¯•æ¡†æ¶ã€‚<br>
e. é¡¹ç›®æ–‡æ¡£çš„è‡ªåŠ¨ç”Ÿæˆï¼Œæ¯”å¦‚doczã€‚<br>
f. gitç›¸å…³çš„ï¼Œæ¯”å¦‚gitæäº¤çš„æ ¡éªŒï¼Œç”Ÿæˆchangelog<br>
g. npmç›¸å…³ï¼Œé™¤éæ˜¯å¼€å‘npmåŒ…ï¼Œå¦åˆ™npmç›¸å…³çš„ä¸æ˜¯é‚£ä¹ˆé‡è¦<br>
h. ä¸å¼€å‘æœ‰å…³çš„å·¥å…·ï¼Œæ¯”å¦‚æ‰“åŒ…æ„å»ºç»“æœçš„åŒ…åˆ†æã€æ¯”å¦‚ç›¸ä¼¼ä»£ç è‡ªåŠ¨ç”Ÿæˆ</p>
</li>
<li>
<p>é¡¹ç›®ä¸Šçº¿è„šæœ¬ï¼Œè¿™ä¸ªåº”è¯¥æ˜¯å¯é€‰é¡¹ï¼Ÿæ›´ä¼˜çš„æ–¹æ³•åº”è¯¥æ˜¯ä½¿ç”¨å†…éƒ¨çš„ä¾‹å¦‚å‘å¸ƒå¹³å°ä¹‹ç±»çš„å·¥å…·å®Œæˆï¼Œæˆ–è€…é€šè¿‡jekinsæˆ–è€…gitlab-ciè¿›è¡Œè‡ªåŠ¨åŒ–å‘å¸ƒï¼Œå›æ»šç­‰æ“ä½œã€‚ä¸Šçº¿å‘å¸ƒå›æ»šçš„åŠ¨ä½œå¯ä»¥å®Œå…¨äº¤ç»™éå¼€å‘äººå‘˜å®Œæˆã€‚<br>
a. æ¯”å¦‚ç”±nodejsç¼–å†™çš„ä¸Šçº¿è„šæœ¬ï¼Œæˆ–è€…æ˜¯ç”¨äºä¸Šçº¿çš„shellè„šæœ¬ã€‚<br>
b. gitlab-ciçš„é…ç½®æ–‡ä»¶</p>
</li>
</ol>
<p>â€¦â€¦<br>
æ€»è€Œè¨€ä¹‹ï¼Œéšç€ä¸šåŠ¡å‘å±•ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šæ²‰æ·€å‡ºä¸€å¥—æ›´â€œä¸ªæ€§åŒ–â€çš„ä¸šåŠ¡æ–¹æ¡ˆã€‚è¿™æ—¶å€™æˆ‘ä»¬æœ€ç›´æ¥çš„åšæ³•å°±æ˜¯å¼€å‘å‡ºä¸€ä¸ªè¯¥æ–¹æ¡ˆçš„è„šæ‰‹æ¶æ¥ï¼Œä»¥ä¾¿ä»Šåèƒ½å¤ç”¨è¿™äº›æœ€ä½³å®è·µä¸æ–¹æ¡ˆã€‚<br>
é‚£ä¹ˆå°±éœ€è¦ä½¿ç”¨ä¸€ä¸ªå·¥å…·æ¥å¸®æˆ‘ä»¬åšè¿™äº›å¤„ç†ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„å°±æ˜¯yomanã€‚<a href="https://yeoman.io/">å®˜ç½‘åœ°å€</a><br>
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨yeomanå’Œyeomançš„generatoræ¥æ›´åŠ ä¾¿æ·å®ç°æˆ‘ä»¬çš„è„šæ‰‹æ¶ï¼Œå¯ä»¥è¯´åŸºæœ¬æ˜¯é›¶æˆæœ¬ã€‚<br>
å…ˆè¯´è¯´Yeomanæ˜¯ä»€ä¹ˆï¼Œå®ƒæƒ³åšä»€ä¹ˆï¼Ÿ<br>
Yeamonå¸®åŠ©ä½ å¿«é€Ÿçš„å¼€å±•ä¸€ä¸ªé¡¹ç›®å·¥ç¨‹ï¼Œæä¾›æœ€ä½³å®è·µå’Œå·¥å…·ï¼Œæ¥è®©ä½ ä¿æŒé«˜æ•ˆç‡ç¼–ç ã€‚</p>
<p>ä»–ä»¬è‡ªå·±æä¾›äº†ä¸€ä¸ªæ„å»ºç”Ÿæ€ç³»ç»Ÿï¼Œä¸»è¦é€šè¿‡â€˜yoâ€™è¿™ä¸ªå‘½ä»¤æ¥æ„å»ºä¸€ä¸ªå®Œæ•´çš„é¡¹ç›®æˆ–è€…é¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>é€šè¿‡å®˜æ–¹çš„ç”Ÿæˆå™¨ï¼Œä»–ä»¬å»ºç«‹äº†ä¸€ä¸ªYeomançš„å·¥ä½œæµï¼Œè¿™ä¸ªæµæ˜¯ç”±ä¸€ä¸ªå¼ºå¤§çš„,å›ºå®šçš„å®¢æˆ·ç«¯ç»„å»ºï¼ŒåŒ…å«å·¥å…·å’Œæ¡†æ¶å¸®åŠ©å¼€å‘è€…å¿«é€Ÿå»ºç«‹ç‰›é€¼çš„webåº”ç”¨ã€‚ä»–ä»¬å°½é‡æä¾›äº†å¼€å‘è€…æ‰€éœ€çš„ä¸œè¥¿ã€‚æ¯”å¦‚å…ˆä¸‹è½½å¯¹åº”æ¨¡ç‰ˆé¡¹ç›®ï¼Œç„¶åä¸‹è½½æ¨¡ç‰ˆé¡¹ç›®ä¸­çš„package.jsonä¸­çš„åŒ…</p>
<p>ä½œä¸ºè‰¯å¥½æ–‡æ¡£å’Œæ·±å…¥æ€è€ƒæ„å»ºè¿‡ç¨‹çš„æ€æƒ³è€…ï¼ŒYeomanåŒ…å«äº†æ£€æµ‹ï¼ˆé™æ€æ£€æµ‹ï¼‰ã€æµ‹è¯•ä»¥åŠå‹ç¼©ç­‰ç­‰ä¸€ç³»åˆ—å·¥å…·ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿæ›´åŠ ä¸“æ³¨äºæ€è€ƒè§£å†³æ–¹æ¡ˆã€‚</p>
<h3 id="å¦‚ä½•ä½¿ç”¨">å¦‚ä½•ä½¿ç”¨ï¼š</h3>
<p>1ã€npm install -g yo //æƒé™ä¸å¤Ÿï¼Œè¯·åŠ ä¸Š sudoï¼Œä¸€èˆ¬æ¥è¯´macéƒ½éœ€è¦ã€‚<br>
å®‰è£…å®Œæˆä¹‹åï¼Œä½ å°±æ‹¥æœ‰äº†1ä¸ªå‘½ä»¤ -- yo å¯ä»¥é€‰æ‹©è‡ªå®šä¹‰çš„ï¼Œä¹Ÿå¯ä»¥æœç´¢ä½ æƒ³è¦çš„ç°æˆçš„ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©è‡ªå·±çš„ã€‚ å®˜ç½‘æä¾›çš„åœ°å€ï¼šhttp://yeoman.io/generators/<br>
é‚£æˆ‘ä»¬å¼€å§‹ç¼–å†™ä¸€ä¸ªè‡ªå·±çš„generatorsã€‚<br>
2ã€å¼€å‘è‡ªå·±çš„generator<br>
åˆ›å»ºé¡¹ç›®<br>
å…¨å±€å®‰è£…generator-generatorï¼Œç„¶åä½¿ç”¨åˆ›å»ºé¡¹ç›®ï¼Œæ ¹æ®æç¤ºè¾“å‡ºæˆ‘ä»¬çš„generatoré¡¹ç›®çš„åå­—ï¼Œyeomanè§„å®šé¡¹ç›®åå­—å¿…é¡»ä»¥generatorå¼€å¤´ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€‰æ‹©generator-xxxä½œä¸ºæˆ‘ä»¬çš„é¡¹ç›®å<br>
npm i -g generator-generator<br>
yo generator<br>
åˆ›å»ºå¥½é¡¹ç›®ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å·²ç»è‡ªåŠ¨ä¸ºæˆ‘ä»¬é…ç½®å¥½äº†eslintï¼Œjestï¼Œhusky</p>
<p>æˆ‘ä»¬ä¸»è¦éœ€è¦ä¿®æ”¹çš„ä»£ç ä½äºgenerators/appå†…<br>
â— index.jså®šä¹‰äº†æˆ‘ä»¬ä½¿ç”¨æ­¤generatoræ—¶çš„ä¸€äº›æ“ä½œé…ç½®é¡¹<br>
â— templateså†…å­˜æ”¾çš„æ˜¯è¦ç”Ÿæˆçš„é¡¹ç›®çš„é¡¹ç›®æ¨¡æ¿ï¼Œé¡¹ç›®æ¨¡æ¿ä¹Ÿå¯ä»¥æ”¾åœ¨gitä¸Šï¼Œç„¶åé€šè¿‡download-git-repoä¸‹è½½åˆ°æœ¬åœ°<br>
éªŒè¯æˆ‘ä»¬åˆ›å»ºçš„é¡¹ç›®</p>
<ol>
<li>åœ¨å½“å‰é¡¹ç›®æ‰§è¡Œnpm linkä½¿å…¶è¢«é“¾æ¥åˆ°å…¨å±€</li>
<li>ç„¶åæ‰¾ä¸€ä¸ªç›®å½•ï¼Œç»ˆç«¯æ‰§è¡Œyoï¼Œæ­¤æ—¶ä¾¿å¯ä»¥å‘ç°æˆ‘ä»¬çš„generatorå·²ç»å‡ºç°åœ¨äº†é€‰æ‹©åˆ—è¡¨ä¸­ã€‚ç„¶åé€‰æ‹©æˆ‘ä»¬çš„generatorè¿è¡Œå³å¯ã€‚ç­‰å¾…å®Œæˆï¼Œä¼šå‘ç°æˆåŠŸçš„åˆ›å»ºäº†ä¸€ä¸ªå«åšdummyfile.txtçš„æ–‡ä»¶å¤¹ã€‚<br>
generators/app/index.js<br>
åˆå§‹åŒ–çš„æ–‡ä»¶å¦‚ä¸‹ã€‚</li>
</ol>
<pre><code>&quot;use strict&quot;;
const Generator = require(&quot;yeoman-generator&quot;);
const chalk = require(&quot;chalk&quot;);
const yosay = require(&quot;yosay&quot;);

module.exports = class extends Generator {
  prompting() {
    // Have Yeoman greet the user.
    this.log(
      yosay(
        `Welcome to the fantastic ${chalk.red(&quot;generator-rc-op&quot;)} generator!`
      )
    );

    const prompts = [
      {
        type: &quot;confirm&quot;,
        name: &quot;someAnswer&quot;,
        message: &quot;Would you like to enable this option?&quot;,
        default: true
      }
    ];

    return this.prompt(prompts).then(props =&gt; {
      // To access props later use this.props.someAnswer;
      this.props = props;
    });
  }

  writing() {
    this.fs.copy(
      this.templatePath(&quot;dummyfile.txt&quot;),
      this.destinationPath(&quot;dummyfile.txt&quot;)
    );
  }

  install() {
    this.installDependencies();
  }
};
</code></pre>
<p>ä»æ–‡ä»¶çš„å†…å®¹å¯ä»¥çœ‹å‡ºä¸»è¦æ“ä½œæ˜¯æš´éœ²å‡ºä¸€ä¸ªç»§æ‰¿è‡ªGeneratorçš„ç±»ï¼Œåœ¨ç±»çš„å†…éƒ¨å®šä¹‰äº†éƒ¨åˆ†ç”Ÿå‘½å‘¨æœŸæ–¹æ³•ï¼Œä¾›yoemanåœ¨é€‚å½“çš„æ—¶å€™è°ƒç”¨ã€‚æˆ‘ä»¬åªéœ€è¦å®Œå–„è¿™äº›æ–¹æ³•å°±å¯ä»¥äº†ã€‚</p>
<h3 id="yeomanæä¾›çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹">yeomanæä¾›çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š</h3>
<ol>
<li>initializingï¼šåˆå§‹åŒ–å¿…è¦çš„ä¾èµ–ï¼Œæˆ–è€…æ¯”å¦‚æ£€æµ‹æ–°ç‰ˆæœ¬</li>
<li>promptingï¼šç”¨æ¥å¤„ç†ç»ˆç«¯çš„äº¤äº’</li>
<li>defaultï¼šè¿™é‡ŒæŒ‡çš„æ˜¯è‡ªå·±è‡ªå®šä¹‰çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯åä¸ºdefaultçš„æ–¹æ³•ï¼Œè‡ªå·±å®šä¹‰çš„æ–¹æ³•å¦‚æœä¸æƒ³è¢«è°ƒç”¨ï¼Œé‚£ä¹ˆéœ€è¦ç¡®ä¿æ–¹æ³•åä»¥_ä¸ºå¼€å¤´ã€‚</li>
<li>writingï¼šå°†ç»è¿‡ejsæ¨¡æ¿æ¸²æŸ“åçš„å†…å®¹å†™å…¥æ–‡ä»¶ç³»ç»Ÿã€‚</li>
<li>conflictsï¼šå‹‡äºè§£å†³å°†æ–‡ä»¶å†…å®¹å†™å…¥æ–‡ä»¶ç³»ç»Ÿæ—¶å¯èƒ½é€ æˆçš„å†²çª</li>
<li>installï¼šå®‰è£…é¡¹ç›®çš„ä¾èµ–ï¼Œæ¯”å¦‚npm install æˆ–è€… bower install</li>
<li>endï¼šåšä¸€äº›æ”¶å°¾çš„å·¥ä½œã€‚</li>
</ol>
<p>è¿™äº›ç”Ÿå‘½å‘¨æœŸæ–¹æ³•å‡æ”¯æŒè¿”å›Promiseæ¥è¿›è¡Œå¼‚æ­¥æ“ä½œã€‚</p>
<h3 id="å†…ç½®å¸¸ç”¨å·¥å…·">å†…ç½®å¸¸ç”¨å·¥å…·</h3>
<p>ç»ˆç«¯äº¤äº’ï¼šå†…ç½®äº†Inquireræä¾›ç»ˆç«¯äº¤äº’<br>
æ¨¡æ¿å¡«å……ï¼šå†…ç½®äº†ejsæ¨¡æ¿<br>
æ–‡ä»¶æ“ä½œ<br>
â— this.fs.copyTplï¼šç”¨äºæ‹·è´å¹¶ä¸”æ ¹æ®æ•°æ®ä½¿ç”¨ejsæ¨¡æ¿æ¸²æŸ“æ–‡ä»¶ã€‚æ­¤å‡½æ•°æ¥å—ä¸‰ä¸ªå‚æ•°ï¼Œæºæ–‡ä»¶è·¯å¾„ï¼Œç›®æ ‡æ–‡ä»¶è·¯å¾„ï¼Œä¼ ç»™ejsç”¨äºæ¸²æŸ“ç›®æ ‡é—®ä»·çš„æ•°æ®ã€‚<br>
â— this.fs.copyï¼šå°†æ–‡ä»¶ä¸›æºè·¯å¾„å¤åˆ¶åˆ°ç›®æ ‡è·¯å¾„ã€‚<br>
â— this.destinationPath() ï¼šæ­¤å‡½æ•°è¿”å›æœ€ç»ˆç”Ÿæˆé¡¹ç›®çš„è·¯å¾„<br>
å…¶ä»–<br>
â— this.npmInstallï¼šå®ç°npm isntall</p>
<pre><code>// éƒ¨åˆ†ä»£ç ï¼Œå®Œæ•´ä»£ç è§æœ€ä¸‹æ–¹é“¾æ¥
writing() {
    const done = this.async();
    this.log(&quot;âš™  Finish basic configuration.&quot;, chalk.green(&quot;âœ”&quot;));
    this.log(&quot;ğŸ“‚ Generate the project template and configuration...&quot;);
    let spinner = ora({
      text: `Download the template from ${GIT_BASE}${TPL_REPOSITORY}...`,
      spinner: ORA_SPINNER
    }).start();
    this._downloadTemplate(TPL_REPOSITORY)
      .then(() =&gt; {
        spinner.stopAndPersist({
          symbol: chalk.green(&quot;   âœ”&quot;),
          text: `Finish downloading the template from ${GIT_BASE}${TPL_REPOSITORY}`
        });
        spinner = ora({
          text: `Copy files into the project folder...`,
          spinner: ORA_SPINNER
        }).start();
        const templateRoot = this.destinationPath(this.dirName, &quot;.tmp&quot;);
        this.log(`\n${templateRoot}`, &quot;templateRoot&quot;);
        const resoPath = path.resolve(templateRoot, &quot;../&quot;);
        this.log(resoPath, &quot;resoPath&quot;);
        spinner.stopAndPersist({
          symbol: chalk.green(&quot;   âœ”&quot;),
          text: `Finish copying files into the project folder`
        });
        execSync(`cp -R ${resoPath}/.tmp/* ${resoPath}`, { stdio: &quot;inherit&quot; });
        spinner = ora({
          text: `Clean tmp files and folders...`,
          spinner: ORA_SPINNER
        }).start();
        fs.removeSync(templateRoot);
        spinner.stopAndPersist({
          symbol: chalk.green(&quot;   âœ”&quot;),
          text: `Finish cleaning tmp files and folders`
        });
        // ExecSync(`rm -R ${resoPath}/.tmp`, { stdio: &quot;inherit&quot; });
        // å°†æ–°ç”Ÿæˆçš„é¡¹ç›®çš„titleæ¢æˆè‡ªå®šä¹‰çš„é¡¹ç›®åç§°
        ejs.renderFile(
          `${resoPath}/public/index.html`,
          { dirName: this.dirName },
          function(err, str) {
            // Str =&gt; è¾“å‡ºæ¸²æŸ“åçš„ HTML å­—ç¬¦ä¸²
            fs.writeFile(`${resoPath}/public/index.html`, str);
          }
        );
        // å°†æ–°ç”Ÿæˆçš„é¡¹ç›®çš„package.jsonçš„nameæ¢æˆè‡ªå®šä¹‰çš„é¡¹ç›®åç§°
        ejs.renderFile(
          `${resoPath}/package.json`,
          { dirName: this.dirName },
          function(err, str) {
            // Str =&gt; è¾“å‡ºæ¸²æŸ“åçš„ HTML å­—ç¬¦ä¸²
            fs.writeFile(`${resoPath}/package.json`, str);
          }
        );
        done();
      })
      .catch(err =&gt; this.env.error(err));
  }
</code></pre>
<h3 id="å…¶ä»–å¯èƒ½ç”¨åˆ°çš„å·¥å…·">å…¶ä»–å¯èƒ½ç”¨åˆ°çš„å·¥å…·</h3>
<p>â— oraï¼šç”¨äºåˆ›å»ºSpinnerï¼Œå³æ¯”å¦‚ä¸‹è½½æ¨¡æ¿æ–‡ä»¶æ—¶éœ€è¦å±•ç¤ºçš„laodingæ•ˆæœã€‚<br>
â— chalkï¼šç”¨äºæ‰“å°å½©è‰²çš„ä¿¡æ¯<br>
â— update-notifier<br>
â— beeper<br>
â— boxen<br>
è°ƒè¯•<br>
ç”±äºyeomanæ˜¯é€šè¿‡npmåŒ…çš„å½¢å¼è¿›è¡Œä½¿ç”¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æˆ‘ä»¬å¼€å‘çš„generatoré¡¹ç›®çš„è·Ÿç›®å½•ä¸‹ï¼Œæ‰§è¡Œnpm link å°†æˆ‘ä»¬å¼€å‘çš„generatoré“¾æ¥åˆ°å…¨å±€ï¼Œè¿™æ ·æˆ‘ä»¬ç›´æ¥ä½¿ç”¨yoå‘½ä»¤æŸ¥çœ‹å¯ä»¥ä½¿ç”¨çš„generatorï¼Œå°±å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ‰€å¼€å‘çš„generatoräº†ï¼Œå¹¶ä¸”æ˜¯å®æ—¶ç”Ÿæ•ˆçš„</p>
<h3 id="æˆ‘çš„ä»£ç æ˜¯åœ¨æœ¬åœ°çš„ç”¨çš„npm-linkæ²¡æœ‰ä¸Šä¼ åˆ°githubæˆ–npmæ­¤å¤„è´´å‡ºå…¶ä»–å¤§ä½¬çš„é¡¹ç›®ä»£ç -å¿«åŠ¨æ‰‹è¯•ä¸€ä¸‹å§~">æˆ‘çš„ä»£ç æ˜¯åœ¨æœ¬åœ°çš„ï¼Œç”¨çš„npm linkï¼Œæ²¡æœ‰ä¸Šä¼ åˆ°githubæˆ–npmï¼Œæ­¤å¤„è´´å‡ºå…¶ä»–å¤§ä½¬çš„é¡¹ç›®ä»£ç ã€‚å¿«åŠ¨æ‰‹è¯•ä¸€ä¸‹å§ï½</h3>
<p><a href="https://github.com/alienzhou/webpack-kickoff-template">æ¨¡ç‰ˆå®Œæ•´ä»£ç </a>   æ³¨æ„è¦ç»™ejså†™å…¥çš„ç©ºä½<br>
<a href="https://github.com/alienzhou/generator-webpack-kickoff">è„šæ‰‹æ¶å®Œæ•´ä»£ç </a></p>
<h3 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« ï¼š</h3>
<p><a href="https://www.yuque.com/kongdepeng/rgpm60/qrluup">å‰ç«¯è‡ªåŠ¨åŒ–å·¥å…· - yeoman</a><br>
<a href="https://zhuanlan.zhihu.com/p/66190308">å¦‚ä½•å¿«é€Ÿå¼€å‘ä¸€ä¸ªè‡ªå·±çš„é¡¹ç›®è„šæ‰‹æ¶ï¼Ÿ</a></p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Cç«¯H5æˆ–å°ç¨‹åºå¸¸è§é—®é¢˜æ€»ç»“]]></title>
        <id>https://weidadeda.github.io/post/c-duan-h5-huo-xiao-cheng-xu-chang-jian-wen-ti-zong-jie</id>
        <link href="https://weidadeda.github.io/post/c-duan-h5-huo-xiao-cheng-xu-chang-jian-wen-ti-zong-jie">
        </link>
        <updated>2021-10-13T13:59:28.000Z</updated>
        <content type="html"><![CDATA[<p>å¼€å‘Cç«¯æ—¶é‡åˆ°çš„ä¸€äº›é—®é¢˜ä¸è§£å†³æ–¹æ³•ï¼Œéƒ½è®°å½•ä¸‹æ¥ï¼Œå¸Œæœ›å¯¹ä½ ä¹Ÿæœ‰å¸®åŠ©ã€‚</p>
<h3 id="1éƒ¨åˆ†æœºå‹æ‹ç…§ä¸Šä¼ å›¾ç‰‡æ—‹è½¬é—®é¢˜">1.éƒ¨åˆ†æœºå‹æ‹ç…§ä¸Šä¼ å›¾ç‰‡æ—‹è½¬é—®é¢˜ï¼š</h3>
<p>ç›´æ¥ä»å›¾ç‰‡åé¢åŠ å‚æ•°â€˜?x-oss-process=image/auto-orient,1/resize,m_fixedâ€™ï¼ˆåŠ ä¸Šå‚æ•°ä¹‹åä¼šè‡ªåŠ¨æ—‹è½¬å›æ¥ï¼Œå…¶ä»–å‚æ•°å¯å‚è€ƒé˜¿é‡ŒOSSå®˜æ–¹æ–‡æ¡£https://help.aliyun.com/document_detail/44691.html?spm=a2c4g.11186623.6.1390.750ac1f6HTe92Qï¼‰</p>
<h3 id="2swiper3dä¸¤è¾¹ç•™ç™½æ•ˆæœ">2.swiper3Dä¸¤è¾¹ç•™ç™½æ•ˆæœï¼š</h3>
<p>ï¼ˆå°ç¨‹åºh5å‡é€‚ç”¨ï¼‰ï¼Œä»£ç å¦‚ä¸‹ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯å¿…é¡»ç»™swiperçˆ¶çº§å…ƒç´ åŠ overflow-x:hidden</p>
<pre><code>.swiper-container {
  height: 100%;
  width: 600px;
  perspective: 1600px;
  overflow: visible;
  img {
    width: 100%;
    height: 720px;
    border-radius: 20px;
  }
}
.swiper-slide {
  padding: 0 24px;
  box-sizing: border-box;
  text-align: center;
  transition: transform 0.5s;
  transform-origin: 50% 50%;
  transform: scale(0.9);
  &amp;.swiper-slide-active {
    transform: scale(1);
  }
}
</code></pre>
<h3 id="3å°ç¨‹åºçš„è·³è½¬åå±‚é™åˆ¶ä¸è¦ä¸€ç›´ç”¨navigatetoè¿™æ ·å±äºä¸€ç›´å‰è¿›å¦‚æœéœ€è¦è·³è½¬å›é¦–é¡µæˆ–è€…å…¶ä»–å¯ä»¥ä½¿ç”¨relaunché€»è¾‘å¤æ‚æ—¶å¯è‡ªå·±å†™é¡¶éƒ¨å¯¼èˆªæ åŒ…æ‹¬è¿”å›æŒ‰é’®">3.å°ç¨‹åºçš„è·³è½¬åå±‚é™åˆ¶ï¼Œä¸è¦ä¸€ç›´ç”¨navigateToï¼Œè¿™æ ·å±äºä¸€ç›´å‰è¿›ï¼Œå¦‚æœéœ€è¦è·³è½¬å›é¦–é¡µæˆ–è€…å…¶ä»–å¯ä»¥ä½¿ç”¨reLaunchï¼Œé€»è¾‘å¤æ‚æ—¶å¯è‡ªå·±å†™é¡¶éƒ¨å¯¼èˆªæ åŒ…æ‹¬è¿”å›æŒ‰é’®ã€‚</h3>
<h3 id="4ä¿å­˜æµ·æŠ¥åˆ°æœ¬åœ°æ¨èä¸€æ³¢ç”Ÿæˆå°ç¨‹åºæµ·æŠ¥çš„æ’ä»¶éå¸¸ç®€å•æ–¹ä¾¿">4.ä¿å­˜æµ·æŠ¥åˆ°æœ¬åœ°ï¼šæ¨èä¸€æ³¢ç”Ÿæˆå°ç¨‹åºæµ·æŠ¥çš„æ’ä»¶ï¼Œéå¸¸ç®€å•æ–¹ä¾¿</h3>
<p>taro-plugin-canvas (Taroç¯å¢ƒä½¿ç”¨)ä¸wxa-plugin-canvasï¼ˆæ™®é€šå°ç¨‹åºä½¿ç”¨ï¼‰<br>
tip:å¦‚æœé‡åˆ°éå¸¸è§„çš„æƒ…å†µï¼Œéœ€è¦æ‰‹å†™canvaså¹¶ä¸”å®½é«˜å°ºå¯¸ä¹˜2ä¿è¯æ¸…æ™°åº¦ã€‚</p>
<h3 id="5inputå…‰æ ‡æ°¸è¿œåœç•™åœ¨æœ€å">5.inputå…‰æ ‡æ°¸è¿œåœç•™åœ¨æœ€åï¼š</h3>
<pre><code>var el = document.getElementById(&quot;IPTname&quot;);
var range = document.createRange();
range.selectNodeContents(el);
range.collapse(false);
var sel = window.getSelection();
sel.removeAllRanges();
sel.addRange(range);
</code></pre>
<h3 id="6å°ç¨‹åºè·å–ç”¨æˆ·æˆæƒç”¨æˆ·ä¿¡æ¯ç”¨æˆ·å®šä½ç”¨æˆ·ç›¸å†Œè®¿é—®æƒé™ç­‰æ—¶éœ€è¦å¤„ç†æ‹’ç»æ—¶çš„æƒ…å†µ-ç”Ÿæˆæµ·æŠ¥åˆ°è‡ªå·±ç›¸å†Œçš„æ—¶å€™å¦‚æœç”¨æˆ·åœ¨æˆæƒçš„æ—¶å€™ç‚¹å‡»äº†æ‹’ç»å¦‚æœä¸å…¼å®¹æ‹’ç»æˆæƒåˆ™ç›´æ¥ç”Ÿæˆå¤±è´¥">6.å°ç¨‹åºè·å–ç”¨æˆ·æˆæƒï¼ˆç”¨æˆ·ä¿¡æ¯/ç”¨æˆ·å®šä½/ç”¨æˆ·ç›¸å†Œè®¿é—®æƒé™ç­‰ï¼‰æ—¶éœ€è¦å¤„ç†æ‹’ç»æ—¶çš„æƒ…å†µã€‚ç”Ÿæˆæµ·æŠ¥åˆ°è‡ªå·±ç›¸å†Œçš„æ—¶å€™å¦‚æœç”¨æˆ·åœ¨æˆæƒçš„æ—¶å€™ç‚¹å‡»äº†æ‹’ç»ï¼Œå¦‚æœä¸å…¼å®¹æ‹’ç»æˆæƒåˆ™ç›´æ¥ç”Ÿæˆå¤±è´¥ã€‚</h3>
<h3 id="7ç›‘å¬ç§»åŠ¨ç«¯é”®ç›˜å¼¹å‡ºå’Œæ”¶èµ·äº‹ä»¶">7.ç›‘å¬ç§»åŠ¨ç«¯é”®ç›˜å¼¹å‡ºå’Œæ”¶èµ·äº‹ä»¶ã€‚</h3>
<p>åœ¨iosè®¾å¤‡ä¸Š,æ“ä½œè¡¨å•è¾“å…¥æ—¶,é”®ç›˜å¼¹å‡ºæ—¶ä¼šæŠŠé¡µé¢é¡¶èµ·æ¥,é”®ç›˜æ”¶èµ·æ—¶å¹¶ä¸ä¼šæŠŠé¡µé¢æ¢å¤æˆåŸæ¥çš„æ ·å­,é€ æˆé¡µé¢æ ·å¼é”™ä¹±,åˆ©ç”¨focusoutå’Œfocusinäº‹ä»¶,å¯ä»¥é—´æ¥åœ°ç›‘å¬åˆ°é”®ç›˜çš„æ”¶èµ·å’Œå¼¹å‡ºäº‹ä»¶,ç„¶åæ“ä½œé¡µé¢æ»šåŠ¨åˆ°æƒ³è¦çš„ä½ç½®.</p>
<p>focusoutè§¦å‘æ—¶æœº:  å½“å…ƒç´ å³å°†å¤±å»ç„¦ç‚¹æ—¶ï¼Œfocusout äº‹ä»¶è¢«è§¦å‘ã€‚focusout äº‹ä»¶å’Œ blur äº‹ä»¶ä¹‹é—´çš„ä¸»è¦åŒºåˆ«åœ¨äºåè€…ä¸ä¼šå†’æ³¡ã€‚</p>
<p>focusinè§¦å‘æ—¶æœº:    å½“å…ƒç´ å³å°†æ¥æ”¶ focus äº‹ä»¶æ—¶ï¼Œfocusin äº‹ä»¶è¢«è§¦å‘ã€‚ è¿™ä¸ªäº‹ä»¶å’Œ focus äº‹ä»¶çš„ä¸»è¦åŒºåˆ«åœ¨äºåè€…ä¸ä¼šå†’æ³¡ã€‚</p>
<p>ç›‘å¬æ–¹å¼:</p>
<pre><code>let scrollTop = 0
//é”®ç›˜æ”¶èµ·
document.body.addEventListener('focusout',()=&gt;{
   document.body.scrollTop=document.documentElement.scrollTop=scrollTop
})
//é”®ç›˜å¼¹å‡º
document.body.addEventListener('focusin',()=&gt;{
   scrollTop = document.body.scrollTop || document.documentElement.scrollTop
})
</code></pre>
<h3 id="8ç§»åŠ¨ç«¯ä»£ç è¿”å›ä¸Šä¸€é¡µwindowlocationbackå¤±æ•ˆ">8.ç§»åŠ¨ç«¯ä»£ç è¿”å›ä¸Šä¸€é¡µï¼ˆwindow.location.back()å¤±æ•ˆï¼‰</h3>
<p>å°¼ç›ã€‚ã€‚ç§»åŠ¨ç«¯è¿”å›ä¸Šä¸€é¡µæœ‰æ—¶å€™ç”¨window.location.back()ä¸å¥½ä½¿ï¼Œæ— è§£ã€‚å¯ä»¥ä½¿ç”¨window.location.href = document.referrerã€‚</p>
<h3 id="9å•é¡µé¢åº”ç”¨è·³è½¬è·¯ç”±ä¹‹åå†æ¬¡ä½¿ç”¨echartsæ—¶ä¸å±•ç¤º">9.å•é¡µé¢åº”ç”¨è·³è½¬è·¯ç”±ä¹‹åå†æ¬¡ä½¿ç”¨echartsæ—¶ä¸å±•ç¤º</h3>
<p>é¦–æ¬¡ä½¿ç”¨ä¸å±•ç¤ºï¼Œå¯ä»¥å»¶è¿ŸåŠ è½½ï¼Œä½†æ˜¯å½“è·¯ç”±è·³è½¬å›æ¥ä¹‹åå»¶è¿Ÿéƒ½ä¸ç®¡ç”¨ï¼Œé‚£ä¹ˆéœ€è¦åœ¨init Echartsä¹‹å‰åŠ¨æ€è®¾ç½®å®¹å™¨å®½é«˜ï¼Œå¹¶ä¸”æ¸…ç©ºçˆ¶å…ƒç´ ï¼Œå› ä¸ºå†æ¬¡å›æ¥çš„æ—¶å€™ä¹‹å‰çš„echartså®ä¾‹å·²ç»æ˜¯å­˜åœ¨çš„äº†ï¼Œå¯åœ¨è°ƒè¯•ä¸­æŸ¥çœ‹è¯¦æƒ…ã€‚</p>
<h3 id="10-è§†é¢‘é»‘è¾¹é—®é¢˜">10. è§†é¢‘é»‘è¾¹é—®é¢˜</h3>
<p>ç»™videoæ ‡ç­¾ï¼ˆåŸç”Ÿvideoæ ‡ç­¾ï¼‰åŠ ä¸€ä¸ªobject-fit:fillå±æ€§å³å¯è§£å†³ã€‚è¦å¼ºè°ƒçš„æ˜¯ï¼Œåƒä¸‡ä¸è¦ä½¿ç”¨Taroçš„Videoæ ‡ç­¾ï¼Œå¾ˆå‘ï¼Œè§£å†³äº†é»‘è¾¹ï¼Œå…¨å±æ—¶åˆä¼šå¯¼è‡´è§†é¢‘å˜å½¢ï¼Œä¸ç”¨object:fillçš„è¯ä¹Ÿèƒ½è§£å†³é»‘è¾¹ï¼Œä½†æ˜¯å…¨å±æ—¶è§†é¢‘çš„é€€å‡ºå…¨å±æ ·å¼åˆä¼šè¢«è¦†ç›–ã€‚</p>
<h3 id="11-æ‰‹æœºé”å±æ—¶å€’è®¡æ—¶åœæ­¢">11. æ‰‹æœºé”å±æ—¶å€’è®¡æ—¶åœæ­¢</h3>
<pre><code>window.addEventListener('visibilitychange',() =&gt; {
   if (
     //hiddenä¸ºé”å±æ—¶æˆ–é¡µé¢ä¸å±•ç¤ºæ—¶ï¼Œå¯é‡æ–°è·å–æ—¶é—´å¼€å§‹å€’è®¡æ—¶ã€‚
      document.visibilityState =='hidden'
   ) 
})
</code></pre>
<h3 id="12ç§»åŠ¨ç«¯å®ç°çœ-å¸‚-åŒº-è¡—é“å››çº§è”åŠ¨">12.ç§»åŠ¨ç«¯å®ç°çœ-å¸‚-åŒº-è¡—é“å››çº§è”åŠ¨</h3>
<p>éœ€æ±‚æ˜¯è¦å®ç°åœ°åŒºå››çº§è”åŠ¨ï¼Œä½†æ˜¯vantçš„æ’ä»¶åªæ”¯æŒä¸‰çº§åœ°åŒºè”åŠ¨ï¼Œå°±å¾ˆå°´å°¬ï¼Œåªèƒ½è‡ªå·±å†™ï¼Œä½†æ˜¯è‡ªå·±å†™çš„è¯UIä¸äº¤äº’ä½“éªŒä¼šå¾ˆå·®ï¼Œæ‰€ä»¥å°±æƒ³åŠæ³•å»å’Œåç«¯å¯¹æ¥ã€‚å…¶å®å¾ˆç®€å•ï¼Œå†™å‡ºæ¥åªæ˜¯æé†’å¤§å®¶å¯ä»¥è¿™ä¹ˆå®ç°ï¼Œå‡å°‘æ€è€ƒä¸è¸©å‘çš„æ—¶é—´ã€‚ä¸‰çº§è”åŠ¨é€‰æ‹©å®Œä¹‹åä¼šè¿”å›åœ°åŒºç¼–ç ï¼Œeg:Array&lt;{code:'110101',name:'ä¸œåŸåŒº'}&gt;,ç„¶åå»è¯·æ±‚åç«¯çš„æ¥å£å°†åœ°åŒºç¼–ç ä¼ è¿‡å»ï¼Œå°±èƒ½å¾—åˆ°å…¶è¡—é“çš„ç›¸å…³ä¿¡æ¯ï¼Œç„¶åç®€å•è¿‡æ»¤ä¸€ä¸‹ï¼Œæ”¾åœ¨Pickeré€‰æ‹©å™¨ä¸­å°±å¯ä»¥å®ç°ã€‚æ¥ä¸‹æ¥å°±å¯ä»¥å†™ä¸šåŠ¡é€»è¾‘äº†ã€‚</p>
<h3 id="13ioså†…webviewä¸­vueé¡¹ç›®ä¼šå‡ºç°å¤§å—ç™½è‰²é®ç½©">13.ioså†…webviewä¸­vueé¡¹ç›®ä¼šå‡ºç°å¤§å—ç™½è‰²é®ç½©</h3>
<p>é—®é¢˜æè¿°ï¼š</p>
<p>Aé¡µé¢â€”â€”&gt;Bé¡µé¢â€”â€”&gt;iosè‡ªå¸¦çš„è¿”å›â€”â€”&gt;ç™½å±å‡ºç°(åƒä¸ªé­”é¬¼)â€”â€”&gt;ç‚¹å‡»æˆ–æ»‘åŠ¨é¡µé¢â€”â€”&gt;é—®é¢˜è§£å†³</p>
<p>åŸå› æ˜¯ï¼Œç»è¿‡æ’æŸ¥ï¼Œå‘ç°åœ¨ios æœºå™¨ä¸Šä½¿ç”¨webview å¼€å‘Vueé¡¹ç›®æ—¶å€™ï¼Œgo history (-1)ï¼Œæ— æ³•å°†body çš„é«˜åº¦æ‹‰æ‰ï¼Œä½¿å¾—é®ä½ï¼Œè§¦å‘è½»ç‚¹å‡»ï¼Œæ–¹å¯æ¶ˆé™¤è¯¥é®ç½©</p>
<p>è§£å†³çš„ç†è®ºï¼šç”¨äºæœ€é‡è¦çš„html å®¹å™¨æ˜¯containerï¼Œç„¶è€Œå› ä¸ºè®¾ç½®htmlã€bodyé«˜åº¦æ˜¯100%ï¼Œä»è€Œé€ æˆäº† container æ’‘å¼€çˆ¶çº§ï¼Œä½†æµè§ˆå™¨é»˜è®¤æ»šåŠ¨çš„scroll å¹¶ä¸æ˜¯ containerï¼Œè€Œæ˜¯bodyï¼ŒæŸäº›å› ç´ ï¼Œé€ æˆè¿”å›history åï¼Œæ— æ³•å¤åŸï¼ˆios çš„é”…ï¼‰ï¼Œä¸ºæ­¤ï¼Œå°† container(app.vueä¸­åŒ…è£¹çš„divï¼Œä¹Ÿå¯ä»¥æ˜¯#app) è¿›è¡Œäº†ç»å¯¹å®šä½ï¼Œå¹¶è®©å®ƒé‡æ–°æˆä¸º scroll çš„å¯¹è±¡ï¼Œä»è€Œè§£å†³é—®é¢˜ã€‚</p>
<pre><code>html, body {

 width: 100%;

 height: 100%;
 min-height: 100vh;

 margin: 0;

 padding: 0;

 position: relative;

}

.container {

 width: 100%;

height: 100vh;
 min-height: 100vh;

 background: #fff;

 overflow: scroll;

 -webkit-overflow-scrolling: touch;

 position: absolute;

 left:0;

 top:0;

}
</code></pre>
<h3 id="14åœ¨iosä¸Šaé¡µé¢åˆ†äº«æœ‹å‹åœˆä¹‹åè·³è½¬åˆ°-b-é¡µé¢æˆ–è¿›è¡Œåˆ«çš„æ“ä½œ">14.åœ¨iosä¸ŠAé¡µé¢åˆ†äº«æœ‹å‹åœˆä¹‹åï¼Œè·³è½¬åˆ° B é¡µé¢ï¼ˆæˆ–è¿›è¡Œåˆ«çš„æ“ä½œï¼‰</h3>
<p>æ³¨ï¼šç¦»å¼€ appçš„ A é¡µé¢å»å¾®ä¿¡ï¼Œå†æ¬¡å›åˆ° app çš„æ—¶å€™è·³è½¬åˆ° B é¡µé¢</p>
<p>visibilitychangeï¼šå½“ç”¨æˆ·æœ€å°åŒ–çª—å£æˆ–è€…åˆ‡æ¢é€‰é¡¹å¡çš„æ—¶å€™ï¼Œapi å°±ä¼šå‘é€visibilitychangeäº‹ä»¶ï¼Œè®©å¼€å‘è€…çŸ¥é“é¡µé¢çŠ¶æ€å·²æ›´æ”¹ã€‚ä½ å¯ä»¥æ£€æµ‹äº‹ä»¶å¹¶æ‰§è¡ŒæŸäº›æ“ä½œæˆ–è¡Œä¸ºã€‚</p>
<pre><code>//è¿™ä¸ªæ–¹æ³•åœ¨åˆ†äº«è¢«è§¦å‘çš„æ—¶å€™æ‰§è¡Œ
initVisibilityChange() {
      if (typeof document.visibilityState != &quot;undefined&quot;) {
        this.visibleChange = &quot;visibilitychange&quot;;
        this.vibibleState = &quot;visibilityState&quot;;
      } else if (
        typeof (document as any).webkitVisibilityState != &quot;undefined&quot;
      ) {
        this.visibleChange = &quot;webkitvisibilitychange&quot;;
        this.vibibleState = &quot;webkitVisibilityState&quot;;
      }
      if (this.visibleChange) {
        document.addEventListener(
          this.visibleChange,
          this.onVisibilityChanged,
          false
        );
      }
    },
      /**
     * ä»å¾®ä¿¡è¿”å›appå¯ä»¥åœ¨è¿™é‡Œé¢å¤„ç†äº‹æƒ…
     */
    onVisibilityChanged(event: any) {
      var hidden = event.target.webkitHidden;
      if ((document as any)[this.vibibleState] == &quot;visible&quot;) {
          this.goRun(); // åšè‡ªå·±éœ€è¦çš„é€»è¾‘å¤„ç†
          this.removeVisibilityChange();
      }
    },
     // ç§»é™¤appåå°ç›‘å¬äº‹ä»¶
    removeVisibilityChange() {
      document.removeEventListener(
        this.visibleChange,
        this.onVisibilityChanged,
        false
      );
    },
</code></pre>
<h3 id="15-ä»vueé¡µé¢è·³è½¬åˆ°évueé¡µé¢ç‚¹å‡»è¿”å›iosè®¾å¤‡ä¸Šé¡µé¢æ•°æ®ä¸åˆ·æ–°">15. ä»vueé¡µé¢è·³è½¬åˆ°évueé¡µé¢ï¼Œç‚¹å‡»è¿”å›ï¼Œiosè®¾å¤‡ä¸Šé¡µé¢æ•°æ®ä¸åˆ·æ–°ã€‚</h3>
<p>æ¯”å¦‚Aé¡µé¢å®šä¹‰äº†ä¸€ä¸ªå˜é‡ä¸ºtrueï¼Œç‚¹å‡»è·³è½¬åˆ°évueé¡¹ç›®é¡µé¢ï¼ˆphpï¼‰ï¼Œç‚¹å‡»è¿”å›ï¼ŒæŸ¥çœ‹è¿™ä¸ªå˜é‡ï¼Œåœ¨å®‰å“ä¸Šä¾ç„¶ä¸ºtureï¼Œä½†æ˜¯åœ¨iosä¸Šå°±å˜æˆäº†falseã€‚</p>
<p>è§£å†³æ–¹æ³•ï¼š</p>
<pre><code>window.onpageshow=function(e){
ã€€ã€€if(e.persisted) {
ã€€ã€€ã€€ã€€window.location.reload()
ã€€ã€€}
};
</code></pre>
<h3 id="16-appç‚¹å‡»è‡ªå¸¦è¿”å›æŒ‰é’®å…³é—­é¡µé¢ä»¥åŠç¦ç”¨è¿”å›çš„è¸©å‘è®°å½•">16. appç‚¹å‡»è‡ªå¸¦è¿”å›æŒ‰é’®å…³é—­é¡µé¢ä»¥åŠç¦ç”¨è¿”å›çš„è¸©å‘è®°å½•</h3>
<p>http://note.youdao.com/s/4qUINhV0 ï¼ˆæ¯”è¾ƒå¤šï¼Œæœ‰é“äº‘é“¾æ¥å‘å‡ºæ¥ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰å¸®åŠ©ï¼‰</p>
<h3 id="17-wxchooseimageæ–¹æ³•åœ¨å®‰å“ä¸iosä¸Šå–åˆ°çš„base64æ ¼å¼ä¸ä¸€æ ·å®‰å“æ²¡æœ‰dataimagejpgbase64å‰ç¼€éœ€è¦å•ç‹¬å¤„ç†">17. wx.chooseImageæ–¹æ³•åœ¨å®‰å“ä¸iosä¸Šå–åˆ°çš„base64æ ¼å¼ä¸ä¸€æ ·ï¼Œå®‰å“æ²¡æœ‰data:image/jpg;base64å‰ç¼€ï¼Œéœ€è¦å•ç‹¬å¤„ç†</h3>
<h3 id="18-æ‰‹æœºå†…h5ç‚¹å‡»inputæ— æ³•å”¤èµ·è‡ªå¸¦é”®ç›˜å¯ä»¥ç»™inputæ·»åŠ clickäº‹ä»¶æ‰‹åŠ¨è§¦å‘focusäº‹ä»¶">18. æ‰‹æœºå†…h5ç‚¹å‡»inputæ— æ³•å”¤èµ·è‡ªå¸¦é”®ç›˜ï¼šå¯ä»¥ç»™inputæ·»åŠ clickäº‹ä»¶æ‰‹åŠ¨è§¦å‘focusäº‹ä»¶ã€‚</h3>
<h3 id="19-canvasç»˜åˆ¶åœ†è§’çŸ©å½¢æ–¹æ³•">19. canvasç»˜åˆ¶åœ†è§’çŸ©å½¢æ–¹æ³•</h3>
<pre><code>// xã€yã€wã€hä¸canvasçš„rectæ–¹æ³•å‚æ•°ç›¸åŒ
//rä»£è¡¨åœ†è§’å¤§å°ï¼Œ1ã€2ã€3ã€4åˆ†åˆ«ä»£è¡¨ä¸Šå·¦ã€ä¸Šå³ã€ä¸‹å³ã€ä¸‹å·¦
function drawRoundRect(ctx, x, y, w, h, r1, r2, r3, r4) {
  ctx.beginPath()
  ctx.moveTo(x + r1, y)
  ctx.arcTo(x + w, y, x + w, y + h, r2)
  ctx.arcTo(x + w, y + h, x, y + h, r3)
  ctx.arcTo(x, y + h, x, y, r4)
  ctx.arcTo(x, y, x + w, y, r1)
  ctx.closePath()
}
</code></pre>
<h3 id="20-postå¯¼å‡ºæ–‡ä»¶å¤„ç†">20. POSTå¯¼å‡ºæ–‡ä»¶å¤„ç†</h3>
<ul>
<li>fetchè¯·æ±‚æ–¹æ³•ä¸­ï¼Œå¢åŠ ç±»å‹å¤„ç†ï¼Œé¢„è®¾è¯·æ±‚ä¼ å…¥å­—æ®µæ§åˆ¶ï¼Œè¿”å›ä¸ºï¼šresponse.blob()ï¼›</li>
<li>è¿”å›å€¼å¤„ç†ï¼š</li>
</ul>
<pre><code>const blob = new Blob([data], {type: &quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;})
    const a = document.createElement(&quot;a&quot;);
    const filename ={
      exportDetail: 'æ¨å¹¿äººå‘˜ç”¨æˆ·æ˜ç»†',
      exportRecord: 'æ¨å¹¿äººå‘˜è·Ÿè¿›è®°å½•æ˜ç»†'
    }
    a.href = URL.createObjectURL(data)
    a.download = filename[type] // è¿™é‡Œå¡«ä¿å­˜æˆçš„æ–‡ä»¶å
    a.click()
    URL.revokeObjectURL(a.href)
ã€€ã€€ a.remove();
</code></pre>
<h3 id="21-è§£å†³cssç€‘å¸ƒæµåªèƒ½ç«–å‘å±•ç¤ºé—®é¢˜éæ’åæˆ–æ’åºæ—¶å¯ç”¨">21. è§£å†³cssç€‘å¸ƒæµåªèƒ½ç«–å‘å±•ç¤ºé—®é¢˜(éæ’åæˆ–æ’åºæ—¶å¯ç”¨)</h3>
<pre><code class="language-css">// çˆ¶å…ƒç´ 
column-count: 2;
width: 100%;
// å­å…ƒç´ 
break-inside: avoid;
</code></pre>
<pre><code class="language-js">const oldList = lists;
const newList = [].concat(
  ...Array.from(
    oldList.reduce(
      (total, cur, index) =&gt; {
        total[index % 2].push(cur);
        return total;
      },
      { 0: [], 1: [], length: 2 }
    )
  )
);
</code></pre>
<h3 id="22-mpvueçš„å‘">22. mpvueçš„å‘</h3>
<ul>
<li>
<p>ä¸€å®šè¦éµå¾ªmpvueå®˜æ–¹æ–‡æ¡£å»ºè®®ï¼Œä¸è¦å°†v-forç”¨åœ¨ç»„ä»¶ä¸Šé¢ï¼Œæˆ–è€…åœ¨v-forå†…åµŒå¥—ç»„ä»¶ï¼Œè¿™æ ·æˆå€å¢åŠ wx.setDataçš„æ•°æ®é‡</p>
</li>
<li>
<p>åœ¨å¼€å‘ä¸Šæ‹‰åŠ è½½æ›´å¤šçš„éœ€æ±‚æ—¶ä¸è¦ä½¿ç”¨å°ç¨‹åºåŸç”Ÿçš„scroll-viewï¼Œç›´æ¥ä½¿ç”¨pageçš„onReachBottomäº‹ä»¶</p>
</li>
<li>
<p>ä½¿ç”¨swiperæ—¶ï¼Œä¸è¦åµŒå¥—è¿‡å¤šswiper-itemï¼Œä¸è¦åœ¨swiper-itemä¸­æ”¾å…¥å¤ªå¤šå…ƒç´ ï¼Œæœ‰ç€‘å¸ƒæµç­‰æ— é™åŠ è½½åˆ—è¡¨éœ€æ±‚æ—¶ï¼Œç¦æ­¢ä½¿ç”¨swiperï¼Œä¼šå¯¼è‡´å°ç¨‹åºå¡æ­»é—ªé€€</p>
</li>
<li>
<p>slotåªèƒ½ä½¿ç”¨åŒ¿åï¼Œå…·åslotåŠscoped slotä¸èƒ½ä½¿ç”¨</p>
</li>
<li>
<p>åœ¨å®šä¹‰ç»„ä»¶dataæ—¶ï¼Œä¸è¦å°†ä¸viewæ— å…³çš„æ•°æ®å®šä¹‰åˆ°dataä¸­ï¼Œç›´æ¥å®šä¹‰åˆ°å¤–éƒ¨ï¼Œç‰¹åˆ«æ—¶ç›‘å¬scrolläº‹ä»¶çš„æ—¶å€™</p>
</li>
<li>
<p>wxå¯¹è±¡çš„æ–¹æ³•å…¨éƒ¨éƒ½æŒ‚åœ¨mpvueå¯¹è±¡ä¸‹ï¼Œä¸éœ€è¦ç›´æ¥è°ƒç”¨wxçš„æ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯åœ¨å…¼å®¹h5çš„æ—¶å€™</p>
</li>
<li>
<p>button open-typeæ˜¯è·å–ç”¨æˆ·æ‰‹æœºå·ç­‰éœ€è¦ç»‘å®šäº‹ä»¶çš„ç±»å‹æ—¶ï¼Œä¸è¦ä½¿ç”¨click.stopæˆ–catch:tapï¼Œè¿™æ ·ä¼šå¯¼è‡´ä¸ä¼šè§¦å‘è·å–ç”¨æˆ·æ‰‹æœºå·çš„å›è°ƒæ–¹æ³•</p>
</li>
<li>
<p>æ‰€æœ‰ç»„ä»¶çš„createdç”Ÿå‘½å‘¨æœŸåªåœ¨å°ç¨‹åºåŠ è½½çš„æ—¶å€™ç»Ÿä¸€æ‰§è¡Œï¼Œå³ä½¿ä½¿ç”¨äº†v-ifä¹Ÿä¸èƒ½åœ¨æ¯æ¬¡åŠ è½½ç»„ä»¶çš„æ—¶å€™è§¦å‘</p>
</li>
<li>
<p>å¦‚æœè¦è‡ªå®šä¹‰tabbaræœ€å¥½è‡ªå·±å®ç°ä¸€ä¸ªï¼Œä¸è¦ä½¿ç”¨åŸç”Ÿçš„customå®šä¹‰ï¼ŒåŸç”Ÿcustomé™åˆ¶å¤ªå¤šä¸”ä¸èƒ½ä½¿ç”¨mpvueå®ç°</p>
</li>
</ul>
<h3 id="23-taro-hookså­ç»„ä»¶æ¡ä»¶æ¸²æŸ“">23. Taro hookså­ç»„ä»¶æ¡ä»¶æ¸²æŸ“</h3>
<p>è‹¥æ˜¯å¸Œæœ›å­ç»„ä»¶propsæœªè¢«é‡æ–°èµ‹å€¼çš„æƒ…å†µä¸‹ä¸æ¸²æŸ“ï¼Œä½¿ç”¨memoåŒ…è£¹ï¼Œå®ƒå®ç°äº†classä¸­PureComponentçš„æ•ˆæœï¼Œæµ…æ¯”è¾ƒäº†ä¸€æ¬¡ã€‚</p>
<pre><code>// å­ç»„ä»¶
import Taro, { memo } from &quot;@tarojs/taro&quot;;
import { View } from &quot;@tarojs/components&quot;;
 
const Index = ({ data }) =&gt; {
  return (
    &lt;View&gt;
      {console.log(&quot;Test -- rander2&quot;, data)}
      {data.map((item, index) =&gt; {
        return &lt;View key={index}&gt;{item}&lt;/View&gt;;
      })}
    &lt;/View&gt;
  );
};
 
export default memo(Index);
</code></pre>
<p>è‹¥æ˜¯å¸Œæœ›åœ¨æŸäº›ç‰¹å®šçš„propæ”¹å˜çš„æ—¶å€™æ›´æ–°å­ç»„ä»¶</p>
<pre><code>// utils
import Taro from &quot;@tarojs/taro&quot;;
 
/**
  * å­ç»„ä»¶æ¡ä»¶æ¸²æŸ“
  * @param {Function} render - è¦æ¸²æŸ“çš„ç»„ä»¶å‡½æ•°
  * @param {Array}  observe - æ¸²æŸ“ä¾æ®ï¼Œä»propsæ¥æ”¶çš„æ•°æ®keyï¼Œ
  */
export const compareRender = (render, observe=[]) =&gt; {
  const compare = (prevProps, nextProps) =&gt; {
    let keep = true;
    for (let i = 0; i &lt; observe.length; i++) {
      if (prevProps[observe[i]] !== nextProps[observe[i]]) {
        keep = false;
        break;
      }
    }
    return keep;
  };
  return Taro.memo(render, compare);
};
</code></pre>
<pre><code>// å­ç»„ä»¶
import Taro from &quot;@tarojs/taro&quot;;
import { View } from &quot;@tarojs/components&quot;;
 
import { compareRender } from &quot;@utils&quot;;
 
const Index = ({ data }) =&gt; {
  return (
    &lt;View&gt;
      {console.log(&quot;Test -- rander&quot;, data)}
      {data.map((item, index) =&gt; {
        return &lt;View key={index}&gt;{item}&lt;/View&gt;;
      })}
    &lt;/View&gt;
  );
};
 
export default compareRender(Index, [&quot;data&quot;]);
</code></pre>
<h3 id="24-å…³äºåœ¨dvaå‰¯ä½œç”¨ä¸­å¤šä¸ªè¯·æ±‚åŒæ­¥æ‰§è¡Œçš„ä¼˜åŒ–">24. å…³äºåœ¨dvaå‰¯ä½œç”¨ä¸­å¤šä¸ªè¯·æ±‚åŒæ­¥æ‰§è¡Œçš„ä¼˜åŒ–</h3>
<p>ç»æµ‹è¯•ï¼š<br>
const res1 = yield call(req1); const res2 = yield call (req2); const res3 = yield call (req3);  ä¸‰ä¸ªè¯·æ±‚åŒæ­¥æ‰§è¡Œï¼Œå¹³å‡è€—æ—¶å¤§çº¦ä¸º120msï¼Œé¡µé¢åŠ è½½ã€æ•°æ®ç­‰å¾…æ—¶é—´è¾ƒé•¿ã€‚<br>
ä¼˜åŒ–ï¼š<br>
const [ res1, res2, res3] =  yield [ call(req1), call(req2), call(req3) ],  å¹¶å‘è¯·æ±‚ï¼Œå¹³å‡è€—æ—¶å¤§çº¦ä¸º20ms</p>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[è‡ªå®šä¹‰ä¸€ä¸ªnewæ–¹æ³•]]></title>
        <id>https://weidadeda.github.io/post/zi-ding-yi-yi-ge-new-fang-fa</id>
        <link href="https://weidadeda.github.io/post/zi-ding-yi-yi-ge-new-fang-fa">
        </link>
        <updated>2021-10-07T12:36:51.000Z</updated>
        <content type="html"><![CDATA[<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/new">MDN new</a></p>
<h3 id="ä¸€-newçš„ä»‹ç»">ä¸€ã€newçš„ä»‹ç»</h3>
<p>newæ˜¯å¹²ä»€ä¹ˆçš„ï¼š</p>
<blockquote>
<p>new è¿ç®—ç¬¦åˆ›å»ºä¸€ä¸ªç”¨æˆ·å®šä¹‰çš„å¯¹è±¡ç±»å‹çš„å®ä¾‹æˆ–å…·æœ‰æ„é€ å‡½æ•°çš„å†…ç½®å¯¹è±¡çš„å®ä¾‹ã€‚</p>
</blockquote>
<p>ä½¿ç”¨newå¯ä»¥å°‘åšå››ä»¶äº‹æƒ…ï¼š</p>
<p>ä¸ç”¨åˆ›å»ºä¸´æ—¶å¯¹è±¡ï¼Œå› ä¸º new ä¼šå¸®ä½ åšï¼ˆä½ ä½¿ç”¨ã€Œthisã€å°±å¯ä»¥è®¿é—®åˆ°ä¸´æ—¶å¯¹è±¡ï¼‰ï¼›<br>
ä¸ç”¨ç»‘å®šåŸå‹ï¼Œå› ä¸º new ä¼šå¸®ä½ åšï¼ˆnew ä¸ºäº†çŸ¥é“åŸå‹åœ¨å“ªï¼Œæ‰€ä»¥æŒ‡å®šåŸå‹çš„åå­—ä¸º prototypeï¼‰ï¼›<br>
ä¸ç”¨ return ä¸´æ—¶å¯¹è±¡ï¼Œå› ä¸º new ä¼šå¸®ä½ åšï¼›<br>
ä¸è¦ç»™åŸå‹æƒ³åå­—äº†ï¼Œå› ä¸º new æŒ‡å®šåå­—ä¸º prototypeã€‚</p>
<p>new å…³é”®å­—ä¼šè¿›è¡Œå¦‚ä¸‹çš„æ“ä½œï¼š</p>
<p>åˆ›å»ºä¸€ä¸ªç©ºçš„ç®€å•JavaScriptå¯¹è±¡ï¼ˆå³{}ï¼‰ï¼›<br>
ä¸ºæ­¥éª¤1æ–°åˆ›å»ºçš„å¯¹è±¡æ·»åŠ å±æ€§__proto__ï¼Œå°†è¯¥å±æ€§é“¾æ¥è‡³æ„é€ å‡½æ•°çš„åŸå‹å¯¹è±¡ ï¼›<br>
å°†æ­¥éª¤1æ–°åˆ›å»ºçš„å¯¹è±¡ä½œä¸ºthisçš„ä¸Šä¸‹æ–‡ ï¼›<br>
å¦‚æœè¯¥å‡½æ•°æ²¡æœ‰è¿”å›å¯¹è±¡ï¼Œåˆ™è¿”å›thisã€‚<br>
ï¼ˆè¯‘æ³¨ï¼šå…³äºå¯¹è±¡çš„ constructorï¼Œå‚è§ Object.prototype.constructorï¼‰</p>
<p>åˆ›å»ºä¸€ä¸ªç”¨æˆ·è‡ªå®šä¹‰çš„å¯¹è±¡éœ€è¦ä¸¤æ­¥ï¼š</p>
<p>é€šè¿‡ç¼–å†™å‡½æ•°æ¥å®šä¹‰å¯¹è±¡ç±»å‹ã€‚<br>
é€šè¿‡ new æ¥åˆ›å»ºå¯¹è±¡å®ä¾‹ã€‚<br>
åˆ›å»ºä¸€ä¸ªå¯¹è±¡ç±»å‹ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªæŒ‡å®šå…¶åç§°å’Œå±æ€§çš„å‡½æ•°ï¼›å¯¹è±¡çš„å±æ€§å¯ä»¥æŒ‡å‘å…¶ä»–å¯¹è±¡ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>
<p>å½“ä»£ç  new Foo(...) æ‰§è¡Œæ—¶ï¼Œä¼šå‘ç”Ÿä»¥ä¸‹äº‹æƒ…ï¼š</p>
<p>ä¸€ä¸ªç»§æ‰¿è‡ª Foo.prototype çš„æ–°å¯¹è±¡è¢«åˆ›å»ºã€‚<br>
ä½¿ç”¨æŒ‡å®šçš„å‚æ•°è°ƒç”¨æ„é€ å‡½æ•° Fooï¼Œå¹¶å°† this ç»‘å®šåˆ°æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚new Foo ç­‰åŒäº new Foo()ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰æŒ‡å®šå‚æ•°åˆ—è¡¨ï¼ŒFoo ä¸å¸¦ä»»ä½•å‚æ•°è°ƒç”¨çš„æƒ…å†µã€‚<br>
ç”±æ„é€ å‡½æ•°è¿”å›çš„å¯¹è±¡å°±æ˜¯ new è¡¨è¾¾å¼çš„ç»“æœã€‚å¦‚æœæ„é€ å‡½æ•°æ²¡æœ‰æ˜¾å¼è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œåˆ™ä½¿ç”¨æ­¥éª¤1åˆ›å»ºçš„å¯¹è±¡ã€‚ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ„é€ å‡½æ•°ä¸è¿”å›å€¼ï¼Œä½†æ˜¯ç”¨æˆ·å¯ä»¥é€‰æ‹©ä¸»åŠ¨è¿”å›å¯¹è±¡ï¼Œæ¥è¦†ç›–æ­£å¸¸çš„å¯¹è±¡åˆ›å»ºæ­¥éª¤ï¼‰<br>
ä½ å§‹ç»ˆå¯ä»¥å¯¹å·²å®šä¹‰çš„å¯¹è±¡æ·»åŠ æ–°çš„å±æ€§ã€‚ä¾‹å¦‚ï¼Œcar1.color = &quot;black&quot; è¯­å¥ç»™ car1 æ·»åŠ äº†ä¸€ä¸ªæ–°çš„å±æ€§ colorï¼Œå¹¶ç»™è¿™ä¸ªå±æ€§èµ‹å€¼ &quot;black&quot;ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ä¼šå½±å“ä»»ä½•å…¶ä»–å¯¹è±¡ã€‚è¦å°†æ–°å±æ€§æ·»åŠ åˆ°ç›¸åŒç±»å‹çš„æ‰€æœ‰å¯¹è±¡ï¼Œä½ å¿…é¡»å°†è¯¥å±æ€§æ·»åŠ åˆ° Car å¯¹è±¡ç±»å‹çš„å®šä¹‰ä¸­ã€‚</p>
<p>ä½ å¯ä»¥ä½¿ç”¨ Function.prototype å±æ€§å°†å…±äº«å±æ€§æ·»åŠ åˆ°ä»¥å‰å®šä¹‰çš„å¯¹è±¡ç±»å‹ã€‚è¿™å®šä¹‰äº†ä¸€ä¸ªç”±è¯¥å‡½æ•°åˆ›å»ºçš„æ‰€æœ‰å¯¹è±¡å…±äº«çš„å±æ€§ï¼Œè€Œä¸ä»…ä»…æ˜¯å¯¹è±¡ç±»å‹çš„å…¶ä¸­ä¸€ä¸ªå®ä¾‹ã€‚ä¸‹é¢çš„ä»£ç å°†ä¸€ä¸ªå€¼ä¸º null çš„ color å±æ€§æ·»åŠ åˆ° car ç±»å‹çš„æ‰€æœ‰å¯¹è±¡ï¼Œç„¶åä»…åœ¨å®ä¾‹å¯¹è±¡ car1 ä¸­ç”¨å­—ç¬¦ä¸² &quot;black&quot; è¦†ç›–è¯¥å€¼</p>
<pre><code>function Car() {}
car1 = new Car();
car2 = new Car();

console.log(car1.color);    // undefined

Car.prototype.color = &quot;original color&quot;;
console.log(car1.color);    // original color

car1.color = 'black';
console.log(car1.color);   // black

console.log(car1.__proto__.color) //original color
console.log(car2.__proto__.color) //original color
console.log(car1.color)  // black
console.log(car2.color) // original color
</code></pre>
<blockquote>
<p>å¦‚æœä½ æ²¡æœ‰ä½¿ç”¨ new è¿ç®—ç¬¦ï¼Œ æ„é€ å‡½æ•°ä¼šåƒå…¶ä»–çš„å¸¸è§„å‡½æ•°ä¸€æ ·è¢«è°ƒç”¨ï¼Œ å¹¶ä¸ä¼šåˆ›å»ºä¸€ä¸ªå¯¹è±¡ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ this çš„æŒ‡å‘ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
</blockquote>
<h3 id="äºŒ-è‡ªå®šä¹‰ä¸€ä¸ªnew">äºŒã€è‡ªå®šä¹‰ä¸€ä¸ªnew</h3>
<pre><code>  // æ„é€ å™¨å‡½æ•°
  let Parent = function (name, age) {
    this.name = name;
    this.age = age;
  };
  Parent.prototype.sayName = function () {
    console.log(this.name);
  };
  //è‡ªå·±å®šä¹‰çš„newæ–¹æ³•
  let newMethod = function (Parent, ...rest) {
    // 1.ä»¥æ„é€ å™¨çš„prototypeå±æ€§ä¸ºåŸå‹ï¼Œåˆ›å»ºæ–°å¯¹è±¡ï¼›
    let child = Object.create(Parent.prototype);
    // 2.å°†thiså’Œè°ƒç”¨å‚æ•°ä¼ ç»™æ„é€ å™¨æ‰§è¡Œ
    Parent.apply(child, rest);
    // 3.è¿”å›ç¬¬ä¸€æ­¥çš„å¯¹è±¡
    return child;
  };
  //åˆ›å»ºå®ä¾‹ï¼Œå°†æ„é€ å‡½æ•°Parentä¸å½¢å‚ä½œä¸ºå‚æ•°ä¼ å…¥
  const child = newMethod(Parent, 'echo', 26);
  child.sayName() //'echo';

  //æœ€åæ£€éªŒï¼Œä¸ä½¿ç”¨newçš„æ•ˆæœç›¸åŒ
  child instanceof Parent//true
  child.hasOwnProperty('name')//true
  child.hasOwnProperty('age')//true
  child.hasOwnProperty('sayName')//false
</code></pre>
]]></content>
    </entry>
</feed>